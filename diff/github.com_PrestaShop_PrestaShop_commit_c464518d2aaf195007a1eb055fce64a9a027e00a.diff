From b6290a64f841176c9a664a83350be8f3cb38f767 Mon Sep 17 00:00:00 2001
From: Pierre RAMBAUD <pierre.rambaud@prestashop.com>
Date: Wed, 18 Mar 2020 17:45:34 +0100
Subject: [PATCH] Make sure the input value is a correct date

---
 classes/helper/HelperCalendar.php | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

diff --git a/classes/helper/HelperCalendar.php b/classes/helper/HelperCalendar.php
index 3ff34ecd1222..2825abdd1c9f 100644
--- a/classes/helper/HelperCalendar.php
+++ b/classes/helper/HelperCalendar.php
@@ -145,17 +145,17 @@ public function getDateFormat()
         return $this->_date_format;
     }
 
-    public function setDateFrom($value)
+    public function setDateFrom($value = '')
     {
-        if (!isset($value) || $value == '') {
-            $value = date('Y-m-d', strtotime('-31 days'));
+        if (empty($value)) {
+            $value = strtotime('-31 days');
         }
 
         if (!is_string($value)) {
             throw new PrestaShopException('Date must be a string');
         }
 
-        $this->_date_from = $value;
+        $this->_date_from = date('Y-m-d', strtotime($value));
 
         return $this;
     }
@@ -163,23 +163,23 @@ public function setDateFrom($value)
     public function getDateFrom()
     {
         if (!isset($this->_date_from)) {
-            $this->_date_from = date('Y-m-d', strtotime('-31 days'));
+            $this->setDateFrom();
         }
 
         return $this->_date_from;
     }
 
-    public function setDateTo($value)
+    public function setDateTo($value = '')
     {
-        if (!isset($value) || $value == '') {
-            $value = date('Y-m-d');
+        if (empty($value)) {
+            $value = strtotime('-31 days');
         }
 
         if (!is_string($value)) {
             throw new PrestaShopException('Date must be a string');
         }
 
-        $this->_date_to = $value;
+        $this->_date_to = date('Y-m-d', strtotime($value));
 
         return $this;
     }
@@ -187,7 +187,7 @@ public function setDateTo($value)
     public function getDateTo()
     {
         if (!isset($this->_date_to)) {
-            $this->_date_to = date('Y-m-d');
+            $this->setDateTo();
         }
 
         return $this->_date_to;
