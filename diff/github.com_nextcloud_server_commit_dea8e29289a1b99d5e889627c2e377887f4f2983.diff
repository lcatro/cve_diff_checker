From dea8e29289a1b99d5e889627c2e377887f4f2983 Mon Sep 17 00:00:00 2001
From: Lukas Reschke <lukas@owncloud.com>
Date: Fri, 1 Jul 2016 15:19:08 +0200
Subject: [PATCH] Match on 405

---
 apps/files/js/filelist.js           | 2 +-
 apps/files/tests/js/filelistSpec.js | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/apps/files/js/filelist.js b/apps/files/js/filelist.js
index c0d72a0f1948..99f28c6b4378 100644
--- a/apps/files/js/filelist.js
+++ b/apps/files/js/filelist.js
@@ -1469,7 +1469,7 @@
 				return false;
 			}
 
-			if (status === 404) {
+			if (status === 404 || status === 405) {
 				// go back home
 				this.changeDirectory('/');
 				return false;
diff --git a/apps/files/tests/js/filelistSpec.js b/apps/files/tests/js/filelistSpec.js
index 9dbdb889eac7..0bdc9c2e05cf 100644
--- a/apps/files/tests/js/filelistSpec.js
+++ b/apps/files/tests/js/filelistSpec.js
@@ -1336,6 +1336,11 @@ describe('OCA.Files.FileList tests', function() {
 			deferredList.reject(404);
 			expect(fileList.getCurrentDirectory()).toEqual('/');
 		});
+		it('switches to root dir when current directory returns 405', function() {
+			fileList.changeDirectory('/unexist');
+			deferredList.reject(405);
+			expect(fileList.getCurrentDirectory()).toEqual('/');
+		});
 		it('switches to root dir when current directory is forbidden', function() {
 			fileList.changeDirectory('/unexist');
 			deferredList.reject(403);
