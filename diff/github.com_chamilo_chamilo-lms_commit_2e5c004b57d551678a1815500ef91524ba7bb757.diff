From 2e5c004b57d551678a1815500ef91524ba7bb757 Mon Sep 17 00:00:00 2001
From: Julio Montoya <gugli100@gmail.com>
Date: Mon, 17 May 2021 09:22:18 +0200
Subject: [PATCH] Add disable_dangerous_file in unzip_uploaded_file

---
 main/inc/lib/fileUpload.lib.php | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/main/inc/lib/fileUpload.lib.php b/main/inc/lib/fileUpload.lib.php
index 0dac97c7f35..e5fea4bbc34 100755
--- a/main/inc/lib/fileUpload.lib.php
+++ b/main/inc/lib/fileUpload.lib.php
@@ -1081,6 +1081,8 @@ function unzip_uploaded_file($uploaded_file, $upload_path, $base_work_dir, $max_
                     }
 
                     $safe_file = api_replace_dangerous_char($file);
+                    $safe_file = disable_dangerous_file($safe_file);
+
                     @rename($base_work_dir.$upload_path.'/'.$file, $base_work_dir.$upload_path.'/'.$safe_file);
                     set_default_settings($upload_path, $safe_file, $filetype);
                 }
