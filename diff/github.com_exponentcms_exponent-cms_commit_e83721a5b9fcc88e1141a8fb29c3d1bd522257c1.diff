From e83721a5b9fcc88e1141a8fb29c3d1bd522257c1 Mon Sep 17 00:00:00 2001
From: dleffler <dleffler@hughes.net>
Date: Thu, 3 Nov 2016 09:45:47 -0400
Subject: [PATCH] fix security vulnerability in search method, reported by
 pang0lin

---
 framework/modules/search/controllers/searchController.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/framework/modules/search/controllers/searchController.php b/framework/modules/search/controllers/searchController.php
index 47bceb426e..fc1f9630b3 100755
--- a/framework/modules/search/controllers/searchController.php
+++ b/framework/modules/search/controllers/searchController.php
@@ -58,7 +58,7 @@ public function search()
         if (get_magic_quotes_gpc()) {
             $terms = stripslashes($terms);
         }
-        $terms = htmlspecialchars($terms);
+        $terms = expString::escape(htmlspecialchars($terms));
 
         if ($router->current_url == substr(URL_FULL, 0, -1)) {  // give us a user friendly url
             unset($router->params['int']);
