From c4a694860b50c4aa5c67d6568f7d0613fef1a30d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fran=C3=A7ois=20Jacquet?=
 <francoisjacquet@users.noreply.github.com>
Date: Tue, 14 Jul 2020 13:41:00 +0200
Subject: [PATCH] Fix #291 XSS Use URLEscape() for links href

---
 modules/Custom/NotifyParents.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/modules/Custom/NotifyParents.php b/modules/Custom/NotifyParents.php
index 66ddcf9c..e6f0e3e2 100644
--- a/modules/Custom/NotifyParents.php
+++ b/modules/Custom/NotifyParents.php
@@ -272,7 +272,7 @@ function _makeAssociated( $value, $column )
 	if ( AllowEdit( 'Users/AddStudents.php' ) )
 	{
 		// Link to Associate Students with Parents program.
-		$link = ' <a href="Modules.php?modname=Users/AddStudents.php&staff_id=' . $THIS_RET['STAFF_ID'] . '">' .
+		$link = ' <a href="' . URLEscape( 'Modules.php?modname=Users/AddStudents.php&staff_id=' . $THIS_RET['STAFF_ID'] ) . '">' .
 			_( 'Associate Students with Parents' ) . '</a>';
 	}
 
@@ -314,7 +314,7 @@ function _makeEmail( $value, $column )
 	if ( AllowEdit( 'Users/User.php' ) )
 	{
 		// Link to User Info program.
-		$return .= ' <a href="Modules.php?modname=Users/User.php&staff_id=' . $THIS_RET['STAFF_ID'] . '">' .
+		$return .= ' <a href="' . URLEscape( 'Modules.php?modname=Users/User.php&staff_id=' . $THIS_RET['STAFF_ID'] ) . '">' .
 			_( 'User Info' ) . '</a>';
 	}
 
-- 
GitLab

