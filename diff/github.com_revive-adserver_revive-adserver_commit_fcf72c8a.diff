From fcf72c8a57f4eee28450ff79060f1297b3dad83d Mon Sep 17 00:00:00 2001
From: Matteo Beccati <matteo@beccati.com>
Date: Tue, 27 Sep 2016 11:22:18 +0200
Subject: [PATCH] Fix h1 report 170156

Reflected XSS
-------------

The HackerOne user pavanw3b has reported that the Revive Adserver web
installer scripts were vulnerable to a reflected XSS attack via the dbHost,
dbUser and possibly other parameters. It has to be noted that the window
for such attack vectors to be possible is extremely narrow and it is very
unlikely that such an attack could be actually effective.

CWE: CWE-79
CVSSv2: 4 (AV:N/AC:H/Au:N/C:P/I:P/A:N)

CVSSv3 Vector: CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C
CVSSv3 Base Score: 4.2
CVSSv3 Temporal Score: 3.7
---
 www/admin/templates/install/messages.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/www/admin/templates/install/messages.html b/www/admin/templates/install/messages.html
index 4df0ac1084..394f71f130 100644
--- a/www/admin/templates/install/messages.html
+++ b/www/admin/templates/install/messages.html
@@ -22,7 +22,7 @@
 			{/if}
 			<span id='errorMessages'>
             {foreach from=$aMessages.error item=error name=messagesLoop}
-              {$error} {if !$smarty.foreach.messagesLoop.last}<br/>{/if}
+              {$error|escape} {if !$smarty.foreach.messagesLoop.last}<br/>{/if}
             {/foreach}
             </span>
           </div>
@@ -46,4 +46,4 @@
 });
 </script>
 {/literal}
-{/if}
\ No newline at end of file
+{/if}
