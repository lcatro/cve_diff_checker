From 333f65bae9106182d12e02d249d4f95e16e93fa2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Tom=C3=A1=C5=A1=20Pole=C5=A1ovsk=C3=BD?=
 <tomas.polesovsky@liferay.com>
Date: Mon, 3 Oct 2016 18:12:10 +0200
Subject: [PATCH] LPS-68469 Missing escape

---
 .../src/main/resources/META-INF/resources/init.jsp           | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp b/modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp
index 5b66d64044e678..3e402560fb130a 100644
--- a/modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp
+++ b/modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp
@@ -19,7 +19,8 @@ taglib uri="http://liferay.com/tld/theme" prefix="liferay-theme" %>
 
 <%@ page import="com.liferay.frontend.js.spa.web.internal.constants.SPAWebKeys" %><%@
 page import="com.liferay.frontend.js.spa.web.internal.servlet.taglib.util.SPAUtil" %><%@
-page import="com.liferay.portal.kernel.language.LanguageUtil" %>
+page import="com.liferay.portal.kernel.language.LanguageUtil" %><%@
+page import="com.liferay.portal.kernel.util.HtmlUtil" %>
 
 <liferay-theme:defineObjects />
 
@@ -33,7 +34,7 @@ SPAUtil spaUtil = (SPAUtil)request.getAttribute(SPAWebKeys.SPA_UTIL);
 	Liferay.SPA.cacheExpirationTime = <%= spaUtil.getCacheExpirationTime(themeDisplay.getCompanyId()) %>;
 	Liferay.SPA.clearScreensCache = <%= spaUtil.isClearScreensCache(request, session) %>;
 	Liferay.SPA.excludedPaths = <%= spaUtil.getExcludedPaths() %>;
-	Liferay.SPA.loginRedirect = '<%= spaUtil.getLoginRedirect(request) %>';
+	Liferay.SPA.loginRedirect = '<%= HtmlUtil.escapeJS(spaUtil.getLoginRedirect(request)) %>';
 	Liferay.SPA.requestTimeout = <%= spaUtil.getRequestTimeout() %>;
 	Liferay.SPA.userNotification = {
 		message: '<%= LanguageUtil.get(spaUtil.getLanguageResourceBundle(themeDisplay.getLocale()), "it-looks-like-this-is-taking-longer-than-expected") %>',
