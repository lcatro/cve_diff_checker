From 517298bafaaff0a8e3dd60dd055a67c41b545807 Mon Sep 17 00:00:00 2001
From: azhou <seviezhou@163.com>
Date: Tue, 10 Sep 2019 02:02:50 +0800
Subject: [PATCH] Try to fix issue #637

Reference: https://github.com/avast/retdec/issues/637
---
 src/bin2llvmir/optimizations/decoder/ir_modifications.cpp | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp b/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
index 40118c3e5..320c0aea6 100644
--- a/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
+++ b/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
@@ -423,6 +423,9 @@ bool Decoder::canSplitFunctionOn(
 				continue;
 			}
 			auto up = fncStarts.upper_bound(bAddr);
+			if (up == fncStarts.begin()) {
+				return false;
+			}	
 			--up;
 			Address bFnc = *up;
 
@@ -442,6 +445,9 @@ bool Decoder::canSplitFunctionOn(
 					continue;
 				}
 				auto up = fncStarts.upper_bound(pAddr);
+				if (up == fncStarts.begin()) {
+					return false;
+				}
 				--up;
 				Address pFnc = *up;
 
