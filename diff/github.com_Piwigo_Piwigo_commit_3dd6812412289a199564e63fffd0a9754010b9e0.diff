From 3dd6812412289a199564e63fffd0a9754010b9e0 Mon Sep 17 00:00:00 2001
From: flop25 <flop25@planete-flop.fr>
Date: Thu, 29 Jun 2017 16:24:15 +0200
Subject: [PATCH] check input parameter for cat_options pages

solving https://github.com/Piwigo/Piwigo/issues/724
---
 admin/cat_options.php | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/admin/cat_options.php b/admin/cat_options.php
index 042adfe960..5fd4d04ce1 100644
--- a/admin/cat_options.php
+++ b/admin/cat_options.php
@@ -44,6 +44,7 @@
     and count($_POST['cat_true']) > 0)
 {
   check_pwg_token();
+  check_input_parameter('cat_true', $_POST, true, PATTERN_ID);
   switch ($_GET['section'])
   {
     case 'comments' :
@@ -82,6 +83,7 @@
          and isset($_POST['cat_false'])
          and count($_POST['cat_false']) > 0)
 {
+  check_input_parameter('cat_false', $_POST, true, PATTERN_ID);
   switch ($_GET['section'])
   {
     case 'comments' :
