From 540d4060e877a03ae95343c1a8560a26768585ee Mon Sep 17 00:00:00 2001
From: Demis Bellot <demis.bellot@gmail.com>
Date: Tue, 4 Aug 2020 14:16:17 +0800
Subject: [PATCH] Update EquivalentTo to test length & null for equality as
 well

---
 src/ServiceStack.Common/EnumerableExtensions.cs | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/ServiceStack.Common/EnumerableExtensions.cs b/src/ServiceStack.Common/EnumerableExtensions.cs
index cc791c31b6a..475351e18d0 100644
--- a/src/ServiceStack.Common/EnumerableExtensions.cs
+++ b/src/ServiceStack.Common/EnumerableExtensions.cs
@@ -234,6 +234,12 @@ public static T FirstNonDefault<T>(this IEnumerable<T> values)
         [MethodImpl(MethodImplOptions.AggressiveInlining)]
         public static bool EquivalentTo(this byte[] bytes, byte[] other)
         {
+            if (bytes == null || other == null)
+                return bytes == other;
+
+            if (bytes.Length != other.Length)
+                return false;
+
             var compare = 0;
             for (var i = 0; i < other.Length; i++)
                 compare |= other[i] ^ bytes[i];
