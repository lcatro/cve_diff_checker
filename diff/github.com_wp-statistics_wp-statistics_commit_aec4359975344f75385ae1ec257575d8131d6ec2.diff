From aec4359975344f75385ae1ec257575d8131d6ec2 Mon Sep 17 00:00:00 2001
From: Mehrshad Darzi <mehrshad198@gmail.com>
Date: Sat, 1 Jun 2019 10:39:35 +0430
Subject: [PATCH] Page's title should be encoded or filtering html
 entities/javascript code #271

---
 includes/class-wp-statistics-pages.php | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/includes/class-wp-statistics-pages.php b/includes/class-wp-statistics-pages.php
index 772abc58..b9c7f9d2 100644
--- a/includes/class-wp-statistics-pages.php
+++ b/includes/class-wp-statistics-pages.php
@@ -295,7 +295,7 @@ public static function get_page_info( $page_id, $type = 'post' ) {
 				case "post":
 				case "page":
 					$arg = array(
-						'title'     => get_the_title( $page_id ),
+						'title'     => esc_html( get_the_title( $page_id ) ),
 						'link'      => get_the_permalink( $page_id ),
 						'edit_link' => get_edit_post_link( $page_id ),
 						'meta'      => array(
@@ -308,7 +308,7 @@ public static function get_page_info( $page_id, $type = 'post' ) {
 				case "tax":
 					$term = get_term( $page_id );
 					$arg  = array(
-						'title'     => $term->name,
+						'title'     => esc_html( $term->name ),
 						'link'      => ( is_wp_error( get_term_link( $page_id ) ) === true ? '' : get_term_link( $page_id ) ),
 						'edit_link' => get_edit_term_link( $page_id ),
 						'meta'      => array(
@@ -327,7 +327,7 @@ public static function get_page_info( $page_id, $type = 'post' ) {
 				case "author":
 					$user_info = get_userdata( $page_id );
 					$arg       = array(
-						'title'     => ( $user_info->display_name != "" ? $user_info->display_name : $user_info->first_name . ' ' . $user_info->last_name ),
+						'title'     => ( $user_info->display_name != "" ? esc_html( $user_info->display_name ) : esc_html( $user_info->first_name . ' ' . $user_info->last_name ) ),
 						'link'      => get_author_posts_url( $page_id ),
 						'edit_link' => get_edit_user_link( $page_id ),
 					);
