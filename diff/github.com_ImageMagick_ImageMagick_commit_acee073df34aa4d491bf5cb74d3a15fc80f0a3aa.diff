From acee073df34aa4d491bf5cb74d3a15fc80f0a3aa Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Sun, 21 May 2017 10:54:16 -0400
Subject: [PATCH] ...

---
 coders/jp2.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/coders/jp2.c b/coders/jp2.c
index 20a5960672..fe2ea13db5 100644
--- a/coders/jp2.c
+++ b/coders/jp2.c
@@ -388,7 +388,11 @@ static Image *ReadJP2Image(const ImageInfo *image_info,ExceptionInfo *exception)
   opj_stream_destroy(jp2_stream);
   for (i=0; i < (ssize_t) jp2_image->numcomps; i++)
   {
-    if ((jp2_image->comps[i].dx == 0) || (jp2_image->comps[i].dy == 0))
+    if ((jp2_image->comps[0].dx == 0) || (jp2_image->comps[0].dy == 0) ||
+        (jp2_image->comps[0].dx != jp2_image->comps[i].dx) ||
+        (jp2_image->comps[0].dy != jp2_image->comps[i].dy) ||
+        (jp2_image->comps[0].prec != jp2_image->comps[i].prec) ||
+        (jp2_image->comps[0].sgnd != jp2_image->comps[i].sgnd))
       {
         opj_destroy_codec(jp2_codec);
         opj_image_destroy(jp2_image);
