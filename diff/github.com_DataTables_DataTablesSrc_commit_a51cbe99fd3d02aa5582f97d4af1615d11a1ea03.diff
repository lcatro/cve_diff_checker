From a51cbe99fd3d02aa5582f97d4af1615d11a1ea03 Mon Sep 17 00:00:00 2001
From: Allan Jardine <allan.jardine@sprymedia.co.uk>
Date: Sun, 25 Oct 2020 10:00:54 +0000
Subject: [PATCH] Fix: Possible prototype pollution if `constructor` were used
 in a data property name

https://github.com/418sec/huntr/pull/827
---
 js/core/core.data.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/js/core/core.data.js b/js/core/core.data.js
index 46ba8049c..d08a20995 100644
--- a/js/core/core.data.js
+++ b/js/core/core.data.js
@@ -357,7 +357,7 @@ function _fnSetObjectDataFn( mSource )
 			for ( var i=0, iLen=a.length-1 ; i<iLen ; i++ )
 			{
 				// Protect against prototype pollution
-				if (a[i] === '__proto__') {
+				if (a[i] === '__proto__' || a[i] === 'constructor') {
 					throw new Error('Cannot set prototype values');
 				}
 
