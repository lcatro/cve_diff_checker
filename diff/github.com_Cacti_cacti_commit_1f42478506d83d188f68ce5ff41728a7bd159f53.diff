From 1f42478506d83d188f68ce5ff41728a7bd159f53 Mon Sep 17 00:00:00 2001
From: cigamit <jimmy@sqmail.org>
Date: Sat, 15 Dec 2018 08:16:10 -0600
Subject: [PATCH] Resolving Issue #2212

Stored XSS in "Website Hostname" field
---
 CHANGELOG   | 1 +
 pollers.php | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG b/CHANGELOG
index 5593a39d2..52558e8a5 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -5,6 +5,7 @@ Cacti CHANGELOG
 -issue#2191: i18n_themes is not properly primed in global_arrays.php
 -issue#2202: Can't create more than one graph with add_graphs.php from one template
 -issue#2207: Removing Graph Template does not Remove Data Query Associations
+-issue#2212: Stored XSS in "Website Hostname" field
 -feature: Update phpseclib to version 2.0.12
 
 1.2.0 Beta 4
diff --git a/pollers.php b/pollers.php
index 793ddfbf6..01262f62c 100644
--- a/pollers.php
+++ b/pollers.php
@@ -849,7 +849,7 @@ function clearFilter() {
 			form_alternate_row('line' . $poller['id'], true, $disabled);
 			form_selectable_cell(filter_value($poller['name'], get_request_var('filter'), 'pollers.php?action=edit&id=' . $poller['id']), $poller['id']);
 			form_selectable_cell($poller['id'], $poller['id'], '', 'right');
-			form_selectable_cell($poller['hostname'], $poller['id'], '', 'right');
+			form_selectable_cell(html_escape($poller['hostname']), $poller['id'], '', 'right');
 			form_selectable_cell($poller_status[$poller['status']], $poller['id'], '', 'center');
 			form_selectable_cell($poller['processes'] . '/' . $poller['threads'], $poller['id'], '', 'right');
 			form_selectable_cell(number_format_i18n($poller['total_time'], 2), $poller['id'], '', 'right');
