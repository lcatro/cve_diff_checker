From 39e25591efddc560e3679ab07e443ee6198705e2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?C=C3=A9dric=20Anne?= <cedric.anne@gmail.com>
Date: Tue, 6 Oct 2020 13:58:51 +0200
Subject: [PATCH] Merge pull request from GHSA-x9hg-j29f-wvvv

---
 inc/knowbaseitem.class.php | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/inc/knowbaseitem.class.php b/inc/knowbaseitem.class.php
index e9e3365dd13..5399aa2b663 100644
--- a/inc/knowbaseitem.class.php
+++ b/inc/knowbaseitem.class.php
@@ -1292,7 +1292,9 @@ static function getListRequest(array $params, $type = 'search') {
 
                }
 
-               $search_where = ['OR' => $ors];
+               $search_where =  $criteria['WHERE']; // Visibility restrict criteria
+
+               $search_where[] = ['OR' => $ors];
 
                // Add visibility date
                $visibility_crit = [
