From 989f9f88ea6db09b99d25586e912c921c0da8d3f Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 4 Aug 2016 10:21:49 -0400
Subject: [PATCH] Prevent buffer overflow (bug report from Max Thrane)

---
 ChangeLog     | 3 +++
 magick/draw.c | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 7376f91a44..e0bdcd1224 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,6 @@
+2016-08-03  6.9.5-5 Cristy  <quetzlzacatenango@image...>
+  * Prevent buffer overflow (bug report from Max Thrane).
+
 2016-07-30  6.9.5-4 Cristy  <quetzlzacatenango@image...>
   * Release ImageMagick version 6.9.5-4, GIT revision 10973:a00fa93:20160729.
 
diff --git a/magick/draw.c b/magick/draw.c
index 03e2fccf9c..bc0b4ebd10 100644
--- a/magick/draw.c
+++ b/magick/draw.c
@@ -2998,7 +2998,7 @@ MagickExport MagickBooleanType DrawImage(Image *image,const DrawInfo *draw_info)
             }
           length++;
         }
-        length=length*BezierQuantum/2;
+        length=length*BezierQuantum;
         break;
       }
       case CirclePrimitive:
