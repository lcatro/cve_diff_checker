From f1c2f906410bf35bb6bd45efff57d2e8da3b3825 Mon Sep 17 00:00:00 2001
From: mjansen <mjansen@databay.de>
Date: Tue, 11 Dec 2018 08:41:36 +0100
Subject: [PATCH] Test: String handling in cloze question

---
 .../TestQuestionPool/classes/class.assClozeTestGUI.php    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/Modules/TestQuestionPool/classes/class.assClozeTestGUI.php b/Modules/TestQuestionPool/classes/class.assClozeTestGUI.php
index e84c8bab0bfb..4799f1430280 100755
--- a/Modules/TestQuestionPool/classes/class.assClozeTestGUI.php
+++ b/Modules/TestQuestionPool/classes/class.assClozeTestGUI.php
@@ -1571,7 +1571,7 @@ public function getAggregatedAnswersView($relevant_answers)
 				foreach($gap->getItems($this->object->getShuffler()) as $gap_item)
 				{
 					$aggregate = $aggregation[$i];
-					$html .= '<li>' . $gap_item->getAnswerText() . ' - ' . ($aggregate[$j] ? $aggregate[$j] : 0) . '</li>';
+					$html .= '<li>' . ilUtil::prepareFormOutput($gap_item->getAnswerText()) . ' - ' . ($aggregate[$j] ? $aggregate[$j] : 0) . '</li>';
 					$j++;
 				}
 				$html .= '</ul>';
@@ -1597,8 +1597,8 @@ public function getAggregatedAnswersView($relevant_answers)
 						$show_mover = ' style="display: none;" ';
 					}
 
-					$html .= '<li>' . $answer . ' - ' . $count
-						. '&nbsp;<button class="clone_fields_add btn btn-link" ' . $show_mover . ' data-answer="'.$answer.'" name="add_gap_'.$i.'_0">
+					$html .= '<li>' . ilUtil::prepareFormOutput($answer) . ' - ' . $count
+						. '&nbsp;<button class="clone_fields_add btn btn-link" ' . $show_mover . ' data-answer="'.ilUtil::prepareFormOutput($answer).'" name="add_gap_'.$i.'_0">
 						<span class="sr-only"></span><span class="glyphicon glyphicon-plus"></span></button>
 						</li>';
 				}
@@ -1615,7 +1615,7 @@ public function getAggregatedAnswersView($relevant_answers)
 					$aggregate = (array)$aggregation[$i];
 					foreach($aggregate as $answer => $count)
 					{
-						$html .= '<li>' . $answer . ' - ' . $count . '</li>';
+						$html .= '<li>' . ilUtil::prepareFormOutput($answer) . ' - ' . $count . '</li>';
 					}
 					$j++;
 				}
