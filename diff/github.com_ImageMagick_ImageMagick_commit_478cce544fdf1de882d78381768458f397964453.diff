From 478cce544fdf1de882d78381768458f397964453 Mon Sep 17 00:00:00 2001
From: dirk <dirk@git.imagemagick.org>
Date: Sun, 14 Feb 2016 08:40:26 +0100
Subject: [PATCH] Fixed SEGV reported in
 https://github.com/ImageMagick/ImageMagick/issues/130

---
 magick/profile.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/magick/profile.c b/magick/profile.c
index 76d2ec4baa..35cdd32ed4 100644
--- a/magick/profile.c
+++ b/magick/profile.c
@@ -1444,7 +1444,8 @@ static void WriteTo8BimProfile(Image *image,const char *name,
     count=(ssize_t) value;
     if ((count & 0x01) != 0)
       count++;
-    if ((p > (datum+length-count)) || (count > (ssize_t) length))
+    if ((count < 0) || (p > (datum+length-count)) ||
+        (count > (ssize_t) length))
       break;
     if (id != profile_id)
       p+=count;
