From 1aaf2182a6b722ad539e2717bc11967d1bde723a Mon Sep 17 00:00:00 2001
From: To-om <toom@thehive-project.org>
Date: Thu, 20 Dec 2018 11:58:39 +0100
Subject: [PATCH] #158 Fix checks in user creation

---
 app/org/thp/cortex/controllers/UserCtrl.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app/org/thp/cortex/controllers/UserCtrl.scala b/app/org/thp/cortex/controllers/UserCtrl.scala
index 7db3d66f1..3e2124bfb 100644
--- a/app/org/thp/cortex/controllers/UserCtrl.scala
+++ b/app/org/thp/cortex/controllers/UserCtrl.scala
@@ -42,7 +42,7 @@ class UserCtrl @Inject() (
       if organization.status() == OrganizationStatus.Active &&
         (request.roles.contains(Roles.superAdmin) ||
           (userOrganizationId == organizationId &&
-            !request.body.getStrings("roles").getOrElse(Nil).contains(Roles.superAdmin.toString)))
+            !request.body.getStrings("roles").getOrElse(Nil).contains(Roles.superAdmin.name)))
       user ‚Üê userSrv.create(request.body.set("organization", organizationId))
     } yield renderer.toOutput(CREATED, user))
       .recoverWith {
