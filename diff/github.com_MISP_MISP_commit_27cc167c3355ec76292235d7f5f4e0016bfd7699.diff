From 27cc167c3355ec76292235d7f5f4e0016bfd7699 Mon Sep 17 00:00:00 2001
From: Iglocska <andras.iklody@gmail.com>
Date: Wed, 1 Jul 2015 11:06:11 +0200
Subject: [PATCH] Fix to an incorrect validation of temporary filenames

---
 VERSION.json                           | 2 +-
 app/Controller/TemplatesController.php | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/VERSION.json b/VERSION.json
index 7174a97dde..1ecf252298 100644
--- a/VERSION.json
+++ b/VERSION.json
@@ -1 +1 @@
-{"major":2, "minor":3, "hotfix":91}
\ No newline at end of file
+{"major":2, "minor":3, "hotfix":92}
\ No newline at end of file
diff --git a/app/Controller/TemplatesController.php b/app/Controller/TemplatesController.php
index 59de353898..95772eb8a2 100644
--- a/app/Controller/TemplatesController.php
+++ b/app/Controller/TemplatesController.php
@@ -334,7 +334,7 @@ public function submitEventPopulation($template_id, $event_id) {
 				$this->loadModel('Attribute');
 				$fails = 0;
 				foreach($attributes as $k => &$attribute) {
-					if (isset($attribute['data'])) {
+					if (isset($attribute['data']) && preg_match('/^[a-zA-Z0-9]{12}$/', $attribute['data'])) {
 						$file = new File(APP . 'tmp/files/' . $attribute['data']);
 						$content = $file->read();
 						$attribute['data'] = base64_encode($content);
