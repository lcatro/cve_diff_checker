From 71436ba5102010397519d4b25ea57591cfb4974c Mon Sep 17 00:00:00 2001
From: Mix Abcprintf <wh.cprintf@gmail.com>
Date: Thu, 19 Dec 2019 05:16:03 +0000
Subject: [PATCH] update #Arbitrary file upload vulnerability

---
 upload.php | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/upload.php b/upload.php
index 17c4ae8..6f2680b 100644
--- a/upload.php
+++ b/upload.php
@@ -9,6 +9,7 @@
             $ready = true;
         }else{
             echo "was not an image<br>";
+            exit();
         }
 
         if($_FILES["fileUpload"]["size"] < 1000000){
@@ -16,11 +17,13 @@
             echo "file size is ".$_FILES['fileUpload']["size"]."<br>";
         }else{
             echo "file was TOO BIG!";
+            exit();
         }
 
         if($_FILES["fileUpload"]["error"]){
             echo "looks like there was an error".$_FILES['fileUpload']["error"]."<br>";
             $ready = false;
+            exit();
         }
 
         $targetPath = "images/".$imageFile;
@@ -28,6 +31,7 @@
         if(file_exists("images/".$imageFile)){
             echo "File already there <br>";
             $ready = false;
+            exit();
         }
 
         if($ready == true){
