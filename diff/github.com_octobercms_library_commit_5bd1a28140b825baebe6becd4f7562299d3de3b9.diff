From 5bd1a28140b825baebe6becd4f7562299d3de3b9 Mon Sep 17 00:00:00 2001
From: Samuel Georges <sam@daftspunk.com>
Date: Wed, 7 Apr 2021 14:03:04 +1000
Subject: [PATCH] Use int casting

These manifested as strings for some users
---
 src/Auth/Models/Role.php | 8 ++++----
 src/Auth/Models/User.php | 8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/src/Auth/Models/Role.php b/src/Auth/Models/Role.php
index 4479c844..92c95ce9 100644
--- a/src/Auth/Models/Role.php
+++ b/src/Auth/Models/Role.php
@@ -84,7 +84,7 @@ public function hasAccess($permissions, $all = true)
 
                     // We will make sure that the merged permission does not
                     // exactly match our permission, but starts with it.
-                    if ($checkPermission != $rolePermission && starts_with($rolePermission, $checkPermission) && $value === 1) {
+                    if ($checkPermission != $rolePermission && starts_with($rolePermission, $checkPermission) && (int) $value === 1) {
                         $matched = true;
                         break;
                     }
@@ -102,7 +102,7 @@ public function hasAccess($permissions, $all = true)
 
                     // We will make sure that the merged permission does not
                     // exactly match our permission, but ends with it.
-                    if ($checkPermission != $rolePermission && ends_with($rolePermission, $checkPermission) && $value === 1) {
+                    if ($checkPermission != $rolePermission && ends_with($rolePermission, $checkPermission) && (int) $value === 1) {
                         $matched = true;
                         break;
                     }
@@ -121,14 +121,14 @@ public function hasAccess($permissions, $all = true)
 
                         // We will make sure that the merged permission does not
                         // exactly match our permission, but starts with it.
-                        if ($checkGroupPermission != $permission && starts_with($permission, $checkGroupPermission) && $value === 1) {
+                        if ($checkGroupPermission != $permission && starts_with($permission, $checkGroupPermission) && (int) $value === 1) {
                             $matched = true;
                             break;
                         }
                     }
                     // Otherwise, we'll fallback to standard permissions checking where
                     // we match that permissions explicitly exist.
-                    elseif ($permission === $rolePermission && $rolePermissions[$permission] === 1) {
+                    elseif ($permission === $rolePermission && (int) $rolePermissions[$permission] === 1) {
                         $matched = true;
                         break;
                     }
diff --git a/src/Auth/Models/User.php b/src/Auth/Models/User.php
index ebba418b..bd524c60 100644
--- a/src/Auth/Models/User.php
+++ b/src/Auth/Models/User.php
@@ -481,7 +481,7 @@ public function hasPermission($permissions, $all = true)
 
                     // We will make sure that the merged permission does not
                     // exactly match our permission, but starts with it.
-                    if ($checkPermission != $mergedPermission && starts_with($mergedPermission, $checkPermission) && $value === 1) {
+                    if ($checkPermission != $mergedPermission && starts_with($mergedPermission, $checkPermission) && (int) $value === 1) {
                         $matched = true;
                         break;
                     }
@@ -496,7 +496,7 @@ public function hasPermission($permissions, $all = true)
 
                     // We will make sure that the merged permission does not
                     // exactly match our permission, but ends with it.
-                    if ($checkPermission != $mergedPermission && ends_with($mergedPermission, $checkPermission) && $value === 1) {
+                    if ($checkPermission != $mergedPermission && ends_with($mergedPermission, $checkPermission) && (int) $value === 1) {
                         $matched = true;
                         break;
                     }
@@ -515,7 +515,7 @@ public function hasPermission($permissions, $all = true)
 
                         // We will make sure that the merged permission does not
                         // exactly match our permission, but starts with it.
-                        if ($checkMergedPermission != $permission && starts_with($permission, $checkMergedPermission) && $value === 1) {
+                        if ($checkMergedPermission != $permission && starts_with($permission, $checkMergedPermission) && (int) $value === 1) {
                             $matched = true;
                             break;
                         }
@@ -523,7 +523,7 @@ public function hasPermission($permissions, $all = true)
 
                     // Otherwise, we'll fallback to standard permissions checking where
                     // we match that permissions explicitly exist.
-                    elseif ($permission === $mergedPermission && $mergedPermissions[$permission] === 1) {
+                    elseif ($permission === $mergedPermission && (int) $mergedPermissions[$permission] === 1) {
                         $matched = true;
                         break;
                     }
