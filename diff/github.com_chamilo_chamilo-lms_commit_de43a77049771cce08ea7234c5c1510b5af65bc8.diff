From de43a77049771cce08ea7234c5c1510b5af65bc8 Mon Sep 17 00:00:00 2001
From: Yannick Warnier <ywarnier@beeznest.org>
Date: Tue, 20 Jul 2021 17:04:07 +0200
Subject: [PATCH] Security: Add script tags filter for users invitations in
 social network

---
 main/inc/lib/social.lib.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/main/inc/lib/social.lib.php b/main/inc/lib/social.lib.php
index 2b8793bbaa9..5137a4a0bf8 100755
--- a/main/inc/lib/social.lib.php
+++ b/main/inc/lib/social.lib.php
@@ -662,6 +662,7 @@ public static function sendInvitationToUser($userId, $subject = '', $content = '
         $user_info = api_get_user_info($userId);
         $success = get_lang('MessageSentTo');
         $success .= ' : '.api_get_person_name($user_info['firstName'], $user_info['lastName']);
+        $content = strip_tags($content);
 
         if (isset($subject) && isset($content) && isset($userId)) {
             $result = MessageManager::send_message($userId, $subject, $content);
