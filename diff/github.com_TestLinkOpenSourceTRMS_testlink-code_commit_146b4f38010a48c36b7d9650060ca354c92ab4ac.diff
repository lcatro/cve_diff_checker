From 146b4f38010a48c36b7d9650060ca354c92ab4ac Mon Sep 17 00:00:00 2001
From: Francisco Mancardi <francisco.mancardi@gmail.com>
Date: Mon, 30 Dec 2019 09:51:24 +0100
Subject: [PATCH] fix: security #8829

---
 lib/requirements/reqCompareVersions.php | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/lib/requirements/reqCompareVersions.php b/lib/requirements/reqCompareVersions.php
index dd04e4bdb6..88ec0d8be3 100644
--- a/lib/requirements/reqCompareVersions.php
+++ b/lib/requirements/reqCompareVersions.php
@@ -247,11 +247,12 @@ function getCFDiff($cfields,&$reqMgr)
 function init_args() {
   $args = new stdClass();
 
-  $args->req_id = isset($_REQUEST['requirement_id']) ? $_REQUEST['requirement_id'] : 0;
+  $args->req_id = isset($_REQUEST['requirement_id']) ? intval($_REQUEST['requirement_id']) : 0;
+
   $args->compare_selected_versions = isset($_REQUEST['compare_selected_versions']);
   $args->left_item_id = isset($_REQUEST['left_item_id']) ? intval($_REQUEST['left_item_id']) : -1;
   $args->right_item_id = isset($_REQUEST['right_item_id']) ? intval($_REQUEST['right_item_id']) :  -1;
-    $args->tproject_id = isset($_SESSION['testprojectID']) ? $_SESSION['testprojectID'] : 0;
+    $args->tproject_id = isset($_SESSION['testprojectID']) ? intval($_SESSION['testprojectID']) : 0;
 
   $args->use_daisydiff = isset($_REQUEST['use_html_comp']);
 
