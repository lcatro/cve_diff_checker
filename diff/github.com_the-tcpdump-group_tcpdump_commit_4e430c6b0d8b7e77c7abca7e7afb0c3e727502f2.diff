From 4e430c6b0d8b7e77c7abca7e7afb0c3e727502f2 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Sun, 5 Mar 2017 13:00:43 -0800
Subject: [PATCH] CVE-2017-12896/ISAKMP: Add another test.

This is from Brian Carpenter for the print-isakmp bug fix.
---
 tests/TESTLIST                |   1 +
 tests/isakmp-3948-oobr-2.out  |   1 +
 tests/isakmp-3948-oobr-2.pcap | Bin 0 -> 88 bytes
 3 files changed, 2 insertions(+)
 create mode 100644 tests/isakmp-3948-oobr-2.out
 create mode 100644 tests/isakmp-3948-oobr-2.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 9e7b0796e..8ae610995 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -437,6 +437,7 @@ ipv6-next-header-oobr-2	ipv6-next-header-oobr-2.pcap	ipv6-next-header-oobr-2.out
 ipv6-rthdr-oobr		ipv6-rthdr-oobr.pcap		ipv6-rthdr-oobr.out
 ieee802.11_tim_ie_oobr	ieee802.11_tim_ie_oobr.pcap	ieee802.11_tim_ie_oobr.out
 decnet-shorthdr-oobr	decnet-shorthdr-oobr.pcap	decnet-shorthdr-oobr.out
+isakmp-3948-oobr-2	isakmp-3948-oobr-2.pcap		isakmp-3948-oobr-2.out
 
 # bad packets from Kamil Frankowicz
 snmp-heapoverflow-1	snmp-heapoverflow-1.pcap	snmp-heapoverflow-1.out
diff --git a/tests/isakmp-3948-oobr-2.out b/tests/isakmp-3948-oobr-2.out
new file mode 100644
index 000000000..cad5686ca
--- /dev/null
+++ b/tests/isakmp-3948-oobr-2.out
@@ -0,0 +1 @@
+IP 48.48.48.48.4500 > 48.48.48.48.12336: [|isakmp]
diff --git a/tests/isakmp-3948-oobr-2.pcap b/tests/isakmp-3948-oobr-2.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..fbea5a9adbde0833340356aea7237ed3fc19e113
GIT binary patch
literal 88
ycmca|c+)~A1{MYbD9~bHU|?i`a}5lDe3%@J=3sCIGl4RKFfjuI!6^u~fdK&C6%W4v

literal 0
HcmV?d00001

