From d21e91f075a7a7a8ed23baa5c1bb1fac48313882 Mon Sep 17 00:00:00 2001
From: Khairul Kasmiran <kazarmy@gmail.com>
Date: Wed, 1 Nov 2017 01:52:54 +0800
Subject: [PATCH] Fix #8764 differently since ptr diff might not fit in
 ptrdiff_t

---
 libr/bin/format/elf/elf.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index ba3d1d5404f..eb0ebe0ed23 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -749,7 +749,7 @@ static Sdb *store_versioninfo_gnu_verdef(ELFOBJ *bin, Elf_(Shdr) *shdr, int sz)
 		verdef->vd_aux = READ32 (dfs, j)
 		verdef->vd_next = READ32 (dfs, j)
 		int vdaux = verdef->vd_aux;
-		if (vdaux < 1 || (char *)UINTPTR_MAX - vstart < vdaux) {
+		if (vdaux < 1 || vstart + vdaux < vstart) {
 			sdb_free (sdb_verdef);
 			goto out_error;
 		}
