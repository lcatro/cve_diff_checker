From 3c1e53dabe966f27c9097a5a923e77f49ae5fffa Mon Sep 17 00:00:00 2001
From: jim-p <jimp@netgate.com>
Date: Mon, 9 Mar 2020 08:55:30 -0400
Subject: [PATCH] Encode user descr before output. Fixes #103241

---
 src/usr/local/www/system_usermanager_addprivs.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/usr/local/www/system_usermanager_addprivs.php b/src/usr/local/www/system_usermanager_addprivs.php
index e5e49b80fe0..d7f507e3656 100644
--- a/src/usr/local/www/system_usermanager_addprivs.php
+++ b/src/usr/local/www/system_usermanager_addprivs.php
@@ -157,7 +157,7 @@ function get_root_priv_item_text() {
 
 $name_string = $a_user['name'];
 if (!empty($a_user['descr'])) {
-	$name_string .= " ({$a_user['descr']})";
+	$name_string .= " (" . htmlspecialchars($a_user['descr']) . ")";
 }
 
 $section->addInput(new Form_StaticText(
