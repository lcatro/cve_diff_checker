From 4f5dc6fb9e50f2c41c4929b0d8c5824b2cca3d65 Mon Sep 17 00:00:00 2001
From: Robin Shen <robin@onedev.io>
Date: Fri, 10 Apr 2020 08:44:57 +0800
Subject: [PATCH] fix issue #88: Users able to edit build spec can execute
 arbitrary java code

---
 server-core/src/main/java/io/onedev/server/CoreModule.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/server-core/src/main/java/io/onedev/server/CoreModule.java b/server-core/src/main/java/io/onedev/server/CoreModule.java
index 5216bd8616..81f2d0200a 100644
--- a/server-core/src/main/java/io/onedev/server/CoreModule.java
+++ b/server-core/src/main/java/io/onedev/server/CoreModule.java
@@ -60,6 +60,7 @@
 import org.hibernate.collection.internal.PersistentBag;
 import org.hibernate.exception.ConstraintViolationException;
 import org.hibernate.type.Type;
+import org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator;
 
 import com.fasterxml.jackson.databind.ObjectMapper;
 import com.google.common.collect.Lists;
@@ -309,7 +310,10 @@ protected void configure() {
 
 			@Override
 			public ValidatorFactory get() {
-				Configuration<?> configuration = Validation.byDefaultProvider().configure();
+				Configuration<?> configuration = Validation
+						.byDefaultProvider()
+						.configure()
+						.messageInterpolator(new ParameterMessageInterpolator());
 				return configuration.buildValidatorFactory();
 			}
 			
