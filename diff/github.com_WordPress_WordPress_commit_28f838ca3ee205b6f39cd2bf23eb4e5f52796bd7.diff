From 28f838ca3ee205b6f39cd2bf23eb4e5f52796bd7 Mon Sep 17 00:00:00 2001
From: Jeremy Felt <jeremy.felt@gmail.com>
Date: Mon, 6 Mar 2017 08:01:43 +0000
Subject: [PATCH] Validate video and audio metadata.

Built from https://develop.svn.wordpress.org/trunk@40148


git-svn-id: http://core.svn.wordpress.org/trunk@40087 1a063a9b-81f0-0310-95a4-ce76da25c4cd
---
 wp-admin/includes/media.php | 4 ++++
 wp-includes/version.php     | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/wp-admin/includes/media.php b/wp-admin/includes/media.php
index ede25b3df76f..d2f4854a2c0f 100644
--- a/wp-admin/includes/media.php
+++ b/wp-admin/includes/media.php
@@ -3072,6 +3072,8 @@ function wp_read_video_metadata( $file ) {
 
 	wp_add_id3_tag_data( $metadata, $data );
 
+	$metadata = wp_kses_post_deep( $metadata );
+
 	return $metadata;
 }
 
@@ -3117,6 +3119,8 @@ function wp_read_audio_metadata( $file ) {
 
 	wp_add_id3_tag_data( $metadata, $data );
 
+	$metadata = wp_kses_post_deep( $metadata );
+
 	return $metadata;
 }
 
diff --git a/wp-includes/version.php b/wp-includes/version.php
index 23d41651c2eb..a54c0193e7da 100644
--- a/wp-includes/version.php
+++ b/wp-includes/version.php
@@ -4,7 +4,7 @@
  *
  * @global string $wp_version
  */
-$wp_version = '4.8-alpha-40147';
+$wp_version = '4.8-alpha-40148';
 
 /**
  * Holds the WordPress DB revision, increments when changes are made to the WordPress DB schema.
