From 3c53413eb544cc567309b4c86485eae43e956112 Mon Sep 17 00:00:00 2001
From: Cristy <mikayla-grace@urban-warrior.org>
Date: Sun, 28 Apr 2019 09:26:45 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1560

---
 coders/tiff.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

diff --git a/coders/tiff.c b/coders/tiff.c
index 10ca0a67eb..a95f78bf1c 100644
--- a/coders/tiff.c
+++ b/coders/tiff.c
@@ -4079,13 +4079,15 @@ RestoreMSCWarning
     if (image->colorspace == LabColorspace)
       DecodeLabImage(image,&image->exception);
     DestroyTIFFInfo(&tiff_info);
-    if (image->exception.severity > ErrorException)
-      break;
 DisableMSCWarning(4127)
     if (0 && (image_info->verbose != MagickFalse))
 RestoreMSCWarning
       TIFFPrintDirectory(tiff,stdout,MagickFalse);
-    (void) TIFFWriteDirectory(tiff);
+    if (TIFFWriteDirectory(tiff) == 0)
+      {
+        status=MagickFalse;
+        break;
+      }
     image=SyncNextImageInList(image);
     if (image == (Image *) NULL)
       break;
@@ -4094,6 +4096,6 @@ RestoreMSCWarning
       break;
   } while (image_info->adjoin != MagickFalse);
   TIFFClose(tiff);
-  return(image->exception.severity > ErrorException ? MagickFalse : MagickTrue);
+  return(status);
 }
 #endif
