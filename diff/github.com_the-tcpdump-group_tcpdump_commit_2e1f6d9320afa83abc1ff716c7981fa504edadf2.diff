From 2e1f6d9320afa83abc1ff716c7981fa504edadf2 Mon Sep 17 00:00:00 2001
From: Francois-Xavier Le Bail <devel.fx.lebail@orange.fr>
Date: Wed, 22 Mar 2017 18:03:24 +0100
Subject: [PATCH] CVE-2017-13024/IPv6 mobility: Add another test for a previous
 bounds check fix

This is another capture file supplied by Bhargava Shastry, modified
so the capture file won't cause 'tcpdump: pcap_loop: truncated dump file'
---
 tests/TESTLIST                 |   1 +
 tests/mobility_opt_asan_4.out  |   1 +
 tests/mobility_opt_asan_4.pcap | Bin 0 -> 140 bytes
 3 files changed, 2 insertions(+)
 create mode 100644 tests/mobility_opt_asan_4.out
 create mode 100644 tests/mobility_opt_asan_4.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 2f3ab1ab5..4c7ab50e2 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -527,6 +527,7 @@ ip_printroute_asan	ip_printroute_asan.pcap		ip_printroute_asan.out	-v
 mobility_opt_asan	mobility_opt_asan.pcap		mobility_opt_asan.out	-v
 mobility_opt_asan_2	mobility_opt_asan_2.pcap	mobility_opt_asan_2.out	-v
 mobility_opt_asan_3	mobility_opt_asan_3.pcap	mobility_opt_asan_3.out	-v
+mobility_opt_asan_4	mobility_opt_asan_4.pcap	mobility_opt_asan_4.out	-v
 
 # RTP tests
 # fuzzed pcap
diff --git a/tests/mobility_opt_asan_4.out b/tests/mobility_opt_asan_4.out
new file mode 100644
index 000000000..d44f4e9d0
--- /dev/null
+++ b/tests/mobility_opt_asan_4.out
@@ -0,0 +1 @@
+IP6 (class 0x50, flowlabel 0x00004, hlim 237, next-header Mobile IP (old) (62) payload length: 7168) d3c3:b2a9:200:400::6238:2949 > 9675:86dd:7300:2c:1c7f:ffff:ffc3:b2a1: mobility: BU seq#=116 A lifetime=15360(pad1)(pad1)(type-0x3c: len=19)(ni: ho=0x0400 co=0x0012)[|MOBILITY]
diff --git a/tests/mobility_opt_asan_4.pcap b/tests/mobility_opt_asan_4.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..c03cad6569e60a8a4d88eceb502e5af295f044e3
GIT binary patch
literal 140
zcmca|c+)~A1{MZ}6do3aZ!t>o3=9m6K>T7|L=-b`2SW;w-O#|maG*hX0mJ<y3tP`=
zrEPap85me(80_9&KD=oqST|5rl7%K%u9$&AN2dP&|NkJ9`B@o&noAnO`GG2Igav>W
T0l^ud4Zpw$Xb#A7A+Rt2`#K|u

literal 0
HcmV?d00001

