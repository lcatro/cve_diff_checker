From e4ef00677ed52f9e5a5fcfcb56b797f5412b5d59 Mon Sep 17 00:00:00 2001
From: stypr <me@harold.kim>
Date: Tue, 15 Sep 2020 15:28:54 +0900
Subject: [PATCH] Block from uploading PHP files to elFinder

---
 cms/soycms/js/elfinder/php/connector.php | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/cms/soycms/js/elfinder/php/connector.php b/cms/soycms/js/elfinder/php/connector.php
index 6f8af669f..67d30279c 100644
--- a/cms/soycms/js/elfinder/php/connector.php
+++ b/cms/soycms/js/elfinder/php/connector.php
@@ -153,7 +153,17 @@ function access($attr, $path, $data, $volume, $isDir, $relpath) {
 			'uploadDeny'    => array('all'),                // All Mimetypes not allowed to upload
 			'uploadAllow'   => array('image', 'text/plain', 'text/css', 'application/zip', 'application/epub+zip','application/pdf'),// Mimetype `image` and `text/plain` allowed to upload
 			'uploadOrder'   => array('deny', 'allow'),      // allowed Mimetype `image` and `text/plain` only
-			'accessControl' => 'access'                     // disable and hide dot starting files (OPTIONAL)
+			'accessControl' => 'access',                     // disable and hide dot starting files (OPTIONAL)
+			'attributes' => array(
+                                //フロントコントローラー
+                                array(
+                                      	'pattern' => '/\\.php(\\.old(\\.[0-9][0-9])?)?$/',
+                                        'read' => false,
+                                        'write' => false,
+                                        'locked' => true,
+                                        'hidden' => true,
+                                ),
+                        )
 		),
 	)
 );
