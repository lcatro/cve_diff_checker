From 0a7bdfa1c166f734d11a1528c8d9a7d61b670ad7 Mon Sep 17 00:00:00 2001
From: lacrioque <markus.fluer@limesurvey.org>
Date: Thu, 19 Dec 2019 16:15:41 +0100
Subject: [PATCH] Fixed issue #15680: LimeSurvey 3.21.1 Cross Site Scripting
 Stored

---
 application/views/admin/token/tokenform.php | 23 +++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)

diff --git a/application/views/admin/token/tokenform.php b/application/views/admin/token/tokenform.php
index 7cf5d6bcc5..97b40d7ccc 100644
--- a/application/views/admin/token/tokenform.php
+++ b/application/views/admin/token/tokenform.php
@@ -147,7 +147,10 @@
                 <?php eT("First name:"); ?>
                 </label>
                 <div class="">
-                <input class='form-control' type='text' size='30' id='firstname' name='firstname' value="<?php if (isset($firstname)) {echo $firstname; } ?>" />
+                    <?=TbHtml::textField('firstname', $firstname, [
+                        'class' => 'form-control',
+                        'size' => '30',
+                    ]);?>
                 </div>
             </div>
             <div class="form-group">
@@ -155,7 +158,10 @@
                 <?php eT("Last name:"); ?>
                 </label>
                 <div class="">
-                <input class='form-control' type='text' size='30' id='lastname' name='lastname' value="<?php if (isset($lastname)) {echo $lastname; } ?>" />
+                    <?=TbHtml::textField('lastname', $lastname, [
+                        'class' => 'form-control',
+                        'size' => '30',
+                    ]);?>
                 </div>
             </div>
 
@@ -189,7 +195,11 @@
                 <?php eT("Email:"); ?>
             </label>
             <div class="">
-                <input class='form-control' type='text' maxlength='320' size='50' id='email' name='email' value="<?php if (isset($email)) {echo $email; } ?>" />
+                <?=TbHtml::emailField('email', $email, [
+                        'class' => 'form-control',
+                        'size' => '50',
+                        'maxlength' => '320' 
+                ]);?>
             </div>
             </div>
 
@@ -199,7 +209,12 @@
                 <?php eT("Email status:"); ?>
             </label>
             <div class="">
-                <input class='form-control' type='text' maxlength='320' size='50' id='emailstatus' name='emailstatus' placeholder='OK' value="<?php if (isset($emailstatus)) {echo $emailstatus; } else {echo " OK "; }?>" />
+                <?=TbHtml::textField('emailstatus', $emailstatus, [
+                        'class' => 'form-control',
+                        'size' => '50',
+                        'maxlength' => '320',
+                        'placeholder' => 'OK'
+                ]);?>
             </div>
             </div>
 
