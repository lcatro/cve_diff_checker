From df167c7db545953bb7f71c72e98e7a3ca0c793bf Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Mon, 3 Dec 2018 15:29:26 +0100
Subject: [PATCH] Fix #12376 - crash in: rasm2 -a arm -b 64 '0 ,0,0,0,0,0,0,'

---
 libr/asm/arch/arm/armass64.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/libr/asm/arch/arm/armass64.c b/libr/asm/arch/arm/armass64.c
index b8f61b79803..91bd4282a77 100644
--- a/libr/asm/arch/arm/armass64.c
+++ b/libr/asm/arch/arm/armass64.c
@@ -737,6 +737,10 @@ static bool parseOperands(char* str, ArmOp *op) {
 		while (token[0] == ' ') {
 			token++;
 		}
+		if (operand >= MAX_OPERANDS) {
+			eprintf ("Too many operands\n");
+			return false;
+		}
 		op->operands[operand].type = ARM_NOTYPE;
 		op->operands[operand].reg_type = ARM_UNDEFINED;
 		op->operands[operand].shift = ARM_NO_SHIFT;
