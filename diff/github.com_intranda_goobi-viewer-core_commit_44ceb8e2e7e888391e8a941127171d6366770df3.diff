From 44ceb8e2e7e888391e8a941127171d6366770df3 Mon Sep 17 00:00:00 2001
From: Florian Alpers <florian.alpers@intranda.com>
Date: Wed, 22 Jul 2020 10:36:58 +0200
Subject: [PATCH] Don't allow filepaths as Filename when requesting source
 files

---
 .../src/main/java/io/goobi/viewer/controller/DataFileTools.java | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/goobi-viewer-core/src/main/java/io/goobi/viewer/controller/DataFileTools.java b/goobi-viewer-core/src/main/java/io/goobi/viewer/controller/DataFileTools.java
index ba0deed85c2..95dc6d8a0a3 100644
--- a/goobi-viewer-core/src/main/java/io/goobi/viewer/controller/DataFileTools.java
+++ b/goobi-viewer-core/src/main/java/io/goobi/viewer/controller/DataFileTools.java
@@ -186,6 +186,8 @@ public static Path getDataFolder(String pi, String dataFolderName, String dataRe
      */
     public static Path getDataFilePath(String pi, String dataFolderName, String altDataFolderName, String fileName)
             throws PresentationException, IndexUnreachableException {
+        //make sure fileName is a pure filename and not a path
+        fileName = Paths.get(fileName).getFileName().toString();
         java.nio.file.Path dataFolderPath = getDataFolder(pi, dataFolderName);
         if (StringUtils.isNotBlank(fileName)) {
             dataFolderPath = dataFolderPath.resolve(fileName);
