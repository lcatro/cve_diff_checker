From ac8003393569aba51048c9d67e1491559877b1d1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?David=20Tschumperl=C3=A9?= <David.Tschumperle@gmail.com>
Date: Thu, 11 Jul 2019 22:12:33 +0200
Subject: [PATCH] .

---
 CImg.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/CImg.h b/CImg.h
index 6c8a8d84..25c39ad8 100644
--- a/CImg.h
+++ b/CImg.h
@@ -49303,7 +49303,8 @@ namespace cimg_library_suffixed {
 
       CImg<ucharT> buffer;
       if (buf_size<cimg_iobuffer) {
-        buffer.assign(cimg::abs(dy)*(dx_bytes + align_bytes),1,1,1,0);
+//        buffer.assign(cimg::abs(dy)*(dx_bytes + align_bytes),1,1,1,0);
+        buffer.assign(buf_size,1,1,1,0);
         cimg::fread(buffer._data,buf_size,nfile);
       } else buffer.assign(dx_bytes + align_bytes);
       unsigned char *ptrs = buffer;
