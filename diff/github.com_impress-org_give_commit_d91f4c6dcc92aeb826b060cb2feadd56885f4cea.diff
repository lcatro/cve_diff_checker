From d91f4c6dcc92aeb826b060cb2feadd56885f4cea Mon Sep 17 00:00:00 2001
From: Ravinder Kumar <ravinder.kumar.apj@gmail.com>
Date: Fri, 12 Jul 2019 19:10:02 +0530
Subject: [PATCH] chore: validate order param for payment query

---
 includes/payments/class-payments-query.php | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/includes/payments/class-payments-query.php b/includes/payments/class-payments-query.php
index 4553ad7a1a..e3a7fb5c33 100644
--- a/includes/payments/class-payments-query.php
+++ b/includes/payments/class-payments-query.php
@@ -157,6 +157,9 @@ private function set_filters() {
 		// While set filters $args will get override and multiple get_payments call will not work.
 		$this->args = $this->_args;
 
+		// Whitelist order.
+		$this->args['order'] = in_array( strtoupper( $this->args['order'] ), array( 'ASC', 'DESC' ) ) ? $this->args['order'] : 'DESC' ;
+
 		$this->date_filter_pre();
 		$this->orderby();
 		$this->status();
