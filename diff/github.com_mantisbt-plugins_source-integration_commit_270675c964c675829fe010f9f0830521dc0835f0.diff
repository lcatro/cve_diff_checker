From 270675c964c675829fe010f9f0830521dc0835f0 Mon Sep 17 00:00:00 2001
From: Damien Regad <dregad@mantisbt.org>
Date: Mon, 10 Feb 2020 23:31:52 +0100
Subject: [PATCH] Fix XSS in Delete Repository page

Fixes #338
---
 Source/pages/repo_delete.php | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/Source/pages/repo_delete.php b/Source/pages/repo_delete.php
index 64b1b8e37..c52ff8c63 100644
--- a/Source/pages/repo_delete.php
+++ b/Source/pages/repo_delete.php
@@ -10,7 +10,8 @@
 
 $t_repo = SourceRepo::load( $f_repo_id );
 
-helper_ensure_confirmed( sprintf( plugin_lang_get( 'ensure_delete' ), $t_repo->name ), plugin_lang_get( 'delete_repository' ) );
+$t_message = sprintf( plugin_lang_get( 'ensure_delete' ), string_attribute( $t_repo->name ) );
+helper_ensure_confirmed( $t_message, plugin_lang_get( 'delete_repository' ) );
 
 SourceRepo::delete( $t_repo->id );
 
