From b5bea2b7f34a5fa9abb4446cbd038ecdbcd09c88 Mon Sep 17 00:00:00 2001
From: Tony <tony.js@zoho.eu>
Date: Mon, 13 Sep 2021 15:04:49 -0300
Subject: [PATCH] fix: prototype pollution fix #1

---
 src/assigner.ts | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/assigner.ts b/src/assigner.ts
index c1e2233..221b373 100644
--- a/src/assigner.ts
+++ b/src/assigner.ts
@@ -1,12 +1,12 @@
 const untracker = [ undefined, null ]
-
+const invalids = [ '__proto__', 'constructor', 'prototype' ]
 const Assigner = function( delegate: ( a: any, b: any ) => any, useuntrack: boolean = true ): ( ...args: any[] ) => any {
   const assigner = ( ...args: any[] ) => {
-    console.log( { args } )
     return args.reduce( ( a, b ) => {
       if ( untracker.includes( a ) ) throw new TypeError( `can't convert ${a} to object` )
       if ( useuntrack && untracker.includes( b ) ) return a
       Object.keys( b ).forEach( key => {
+        if ( invalids.includes( key ) ) return void 0
         if ( untracker.includes( a[key] ) ) a[key] = b[key]
         else a[key] = delegate.call( this, a[key], b[key] )
       } )
