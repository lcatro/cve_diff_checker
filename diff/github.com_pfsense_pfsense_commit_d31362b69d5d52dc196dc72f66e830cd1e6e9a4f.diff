From d31362b69d5d52dc196dc72f66e830cd1e6e9a4f Mon Sep 17 00:00:00 2001
From: jim-p <jimp@netgate.com>
Date: Mon, 1 Jul 2019 14:37:12 -0400
Subject: [PATCH] Encode error output in services_captiveportal_mac.php. Fixes
 #9609

---
 src/usr/local/www/services_captiveportal_mac.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/usr/local/www/services_captiveportal_mac.php b/src/usr/local/www/services_captiveportal_mac.php
index 4621fe5c5ec..036c8537da0 100644
--- a/src/usr/local/www/services_captiveportal_mac.php
+++ b/src/usr/local/www/services_captiveportal_mac.php
@@ -89,7 +89,7 @@
 			if (!empty($mac)) {
 				$_POST['delmac'] = $mac['mac'];
 			} else {
-				echo gettext("No entry exists for this username:") . " " . $_POST['username'] . "\n";
+				echo gettext("No entry exists for this username:") . " " . htmlspecialchars($_POST['username']) . "\n";
 			}
 		}
 
@@ -112,7 +112,7 @@
 				write_config();
 				echo gettext("The entry was successfully deleted") . "\n";
 			} else {
-				echo gettext("No entry exists for this mac address:") . " " . $_POST['delmac'] . "\n";
+				echo gettext("No entry exists for this mac address:") . " " . htmlspecialchars($_POST['delmac']) . "\n";
 			}
 		}
 		exit;
