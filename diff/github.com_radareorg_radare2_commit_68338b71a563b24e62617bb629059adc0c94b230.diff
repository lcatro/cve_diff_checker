From 68338b71a563b24e62617bb629059adc0c94b230 Mon Sep 17 00:00:00 2001
From: h4ng3r <h4ng3r@users.noreply.github.com>
Date: Wed, 1 Mar 2017 12:39:11 +0100
Subject: [PATCH] fix #6872

---
 libr/bin/p/bin_dex.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/libr/bin/p/bin_dex.c b/libr/bin/p/bin_dex.c
index 7293c389a2e..13a7b45430a 100644
--- a/libr/bin/p/bin_dex.c
+++ b/libr/bin/p/bin_dex.c
@@ -377,6 +377,9 @@ static void dex_parse_debug_item(RBinFile *binfile, RBinDexObj *bin,
 		--parameters_size;
 	}
 
+	if (p4 <= 0) {
+		return;
+	}
 	ut8 opcode = *(p4++) & 0xff;
 	while (keep) {
 		switch (opcode) {
