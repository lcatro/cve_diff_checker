From 2ddffb2e7eafe4830e3483a4b437873022c461ba Mon Sep 17 00:00:00 2001
From: dleffler <dleffler@hughes.net>
Date: Thu, 3 Nov 2016 10:15:00 -0400
Subject: [PATCH] fix security vulnerability to reranking pages; reported by
 kyohpc

---
 .../modules/navigation/controllers/navigationController.php | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/framework/modules/navigation/controllers/navigationController.php b/framework/modules/navigation/controllers/navigationController.php
index 90180d6276..ebe59313bf 100644
--- a/framework/modules/navigation/controllers/navigationController.php
+++ b/framework/modules/navigation/controllers/navigationController.php
@@ -39,6 +39,8 @@ class navigationController extends expController {
         'move'      => 'Move Page',
         'remove'    => 'Remove Page',
         'reparent'    => 'Reparent Page',
+        'dragndroprerank'    => 'Rerank Page',
+        'dragndroprerank2'    => 'Rerank Page',
     );
     public $remove_configs = array(
         'aggregation',
@@ -858,8 +860,8 @@ public static function returnChildrenAsJSON2() {
     public static function DragnDropReRank() {
         global $db, $router;
 
-        $move   = $router->params['move'];
-        $target = $router->params['target'];
+        $move   = intval($router->params['move']);
+        $target = intval($router->params['target']);
         $type   = $router->params['type'];
         $targSec = $db->selectObject("section","id=".$target);
 //        $targSec  = new section($target);
