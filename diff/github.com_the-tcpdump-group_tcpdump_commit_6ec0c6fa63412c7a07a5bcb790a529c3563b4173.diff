From 6ec0c6fa63412c7a07a5bcb790a529c3563b4173 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Tue, 7 Feb 2017 10:55:59 -0800
Subject: [PATCH] CVE-2017-12902/Zephyr: Add an additional test.

File from Kamil Frankowicz.
---
 tests/TESTLIST               |   1 +
 tests/hoobr_parse_field.out  |   5 +++++
 tests/hoobr_parse_field.pcap | Bin 0 -> 164 bytes
 3 files changed, 6 insertions(+)
 create mode 100644 tests/hoobr_parse_field.out
 create mode 100644 tests/hoobr_parse_field.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index f14868fc4..7b841e991 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -454,6 +454,7 @@ hoobr_ripng_print	hoobr_ripng_print.pcap		hoobr_ripng_print.out
 hoobr_juniper		hoobr_juniper.pcap		hoobr_juniper.out
 hoobr_juniper2		hoobr_juniper2.pcap		hoobr_juniper2.out
 hoobr_juniper3		hoobr_juniper3.pcap		hoobr_juniper3.out
+hoobr_parse_field	hoobr_parse_field.pcap		hoobr_parse_field.out
 
 # bad packets from Wilfried Kirsch
 slip-bad-direction	slip-bad-direction.pcap		slip-bad-direction.out	-ve
diff --git a/tests/hoobr_parse_field.out b/tests/hoobr_parse_field.out
new file mode 100644
index 000000000..2eecd7379
--- /dev/null
+++ b/tests/hoobr_parse_field.out
@@ -0,0 +1,5 @@
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+	0x0010:  3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+	0x0020:  3030                                     00
+IP 48.48.48.48.2104 > 48.48.48.48.12336:  [|zephyr] (12308)
diff --git a/tests/hoobr_parse_field.pcap b/tests/hoobr_parse_field.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..f76d6282a98a2f0a38d4c6946f03393937fd3093
GIT binary patch
literal 164
ycmca|c+)~A1{MYb7+_#vU}QjWZGe236vZ?avp5)B!Nvk@5k#2JVS!*97ytmf3>_Q*

literal 0
HcmV?d00001

