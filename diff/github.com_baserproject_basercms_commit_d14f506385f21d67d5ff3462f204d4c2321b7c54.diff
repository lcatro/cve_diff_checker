From 5e514adef5fc0c83aa36f7b6f3dd685a8153a5a0 Mon Sep 17 00:00:00 2001
From: gondoh <gondoh@catchup.co.jp>
Date: Tue, 27 Oct 2020 15:31:09 +0900
Subject: [PATCH 1/2] =?UTF-8?q?=E3=83=96=E3=83=AD=E3=82=B0=E3=82=B3?=
 =?UTF-8?q?=E3=83=A1=E3=83=B3=E3=83=88=E3=81=AE=E5=90=8D=E5=89=8D=E8=A1=A8?=
 =?UTF-8?q?=E7=A4=BA=E3=82=92=E6=94=B9=E5=96=84?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php    | 2 +-
 lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php b/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
index 46dca68d36..cd14b7c96b 100755
--- a/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
+++ b/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
@@ -27,7 +27,7 @@
 		<?php if ($dbData['url']): ?>
 			<?php $this->BcBaser->link($dbData['name'], $dbData['url'], ['target' => '_blank']) ?>
 		<?php else: ?>
-			<?php echo $dbData['name'] ?>
+			<?php echo h($dbData['name']) ?>
 		<?php endif ?>
 	</div>
 	<div class="bs-blog-comment__list-item-message">
diff --git a/lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php b/lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php
index 43a955742e..45d09d954a 100644
--- a/lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php
+++ b/lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php
@@ -11,7 +11,7 @@
 	'data-alertMessageComplate' => __('コメントの送信が完了しました。'),
 	'data-alertMessageError' => __('コメントの送信に失敗しました。入力内容を見なおしてください。'),
 ]); ?>
-<div id="BaseUrl" style="display: none"><?php echo $this->request->base; ?></div>
+<div id="BaseUrl" style="display: none"><?php echo h($this->request->base); ?></div>
 
 <script>
 	authCaptcha = <?php echo $blogContent['BlogContent']['auth_captcha'] ? 'true' : 'false'; ?>;

From 9dc5aeba4f9f67328a08c1863cd8bfed8efce57e Mon Sep 17 00:00:00 2001
From: gondoh <gondoh@catchup.co.jp>
Date: Tue, 27 Oct 2020 15:32:59 +0900
Subject: [PATCH 2/2] =?UTF-8?q?=E3=83=96=E3=83=AD=E3=82=B0=E3=82=B3?=
 =?UTF-8?q?=E3=83=A1=E3=83=B3=E3=83=88=E3=81=AE=E5=90=8D=E5=89=8D=E8=A1=A8?=
 =?UTF-8?q?=E7=A4=BA=E3=82=92=E6=94=B9=E5=96=84?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php b/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
index cd14b7c96b..5e6ae14d61 100755
--- a/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
+++ b/lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php
@@ -25,7 +25,7 @@
 <div class="bs-blog-comment__list-item" id="Comment<?php echo $dbData['no'] ?>">
 	<div class="bs-blog-comment__list-item-name">
 		<?php if ($dbData['url']): ?>
-			<?php $this->BcBaser->link($dbData['name'], $dbData['url'], ['target' => '_blank']) ?>
+			<?php $this->BcBaser->link($dbData['name'], $dbData['url'], ['target' => '_blank', 'escape' => true]) ?>
 		<?php else: ?>
 			<?php echo h($dbData['name']) ?>
 		<?php endif ?>
