From 4a8b24475549ff10bdf6d07fd4b5f6c1cc6246ea Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=EC=A0=95=EC=9E=AC=EC=98=81?= <2017036335@hanyang.ac.kr>
Date: Thu, 2 Jul 2020 12:15:50 -0700
Subject: [PATCH] patch two stack buffer overflow. In disassembling swf
 function

---
 libr/asm/arch/swf/swfdis.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libr/asm/arch/swf/swfdis.c b/libr/asm/arch/swf/swfdis.c
index 4ec231085d..ab774e80f2 100644
--- a/libr/asm/arch/swf/swfdis.c
+++ b/libr/asm/arch/swf/swfdis.c
@@ -162,7 +162,7 @@ int r_asm_swf_disass(RBinObject *obj, char* buf_asm, const ut8* buf, int len, ut
 		}
 		case SWFACTION_GETURL: {
 			char* url = (char*) buf+1;
-			sprintf (buf_asm, "%s %s", op.name, url);
+			snprintf (buf_asm, 1024,"%s %s", op.name, url);
 			dlen = strlen (url) + 2;
 			break;
 		}
@@ -203,7 +203,7 @@ int r_asm_swf_disass(RBinObject *obj, char* buf_asm, const ut8* buf, int len, ut
 		}
 		case SWFACTION_SETTARGET: {
 			char* target = (char*) buf+1;
-			sprintf (buf_asm, "%s %s", op.name, target);
+			sprintf (buf_asm, 1024,"%s %s", op.name, target);
 			dlen = 1;
 			break;
 		}
