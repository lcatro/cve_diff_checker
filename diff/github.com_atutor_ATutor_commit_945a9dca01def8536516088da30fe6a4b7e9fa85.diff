From 945a9dca01def8536516088da30fe6a4b7e9fa85 Mon Sep 17 00:00:00 2001
From: Steven Seeley <steventhomasseeley@gmail.com>
Date: Mon, 7 Mar 2016 09:12:46 -0500
Subject: [PATCH] Update mysql_connect.inc.php

This one patch, patches all SQL Injection that I found
---
 include/lib/mysql_connect.inc.php | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

diff --git a/include/lib/mysql_connect.inc.php b/include/lib/mysql_connect.inc.php
index 9c54fc38b..93d22d826 100644
--- a/include/lib/mysql_connect.inc.php
+++ b/include/lib/mysql_connect.inc.php
@@ -93,14 +93,8 @@ function my_null_slashes($string) {
     $addslashes   = 'my_add_null_slashes';
     $stripslashes = 'stripslashes';
 } else {
-    if(defined('MYSQLI_ENABLED')){
-        // mysqli_real_escape_string requires 2 params, breaking wherever
-        // current $addslashes with 1 param exists. So hack with trim and 
-        // manually run mysqli_real_escape_string requires during sanitization below
-        $addslashes   = 'trim';
-    }else{
-        $addslashes   = 'mysql_real_escape_string';
-    }
+    // if get_magic_quotes_gpc is off, we set our own handler
+    $addslashes   = 'mysql_real_escape_string';
     $stripslashes = 'my_null_slashes';
 }
 
@@ -406,4 +400,4 @@ function at_field_name($result, $i){
 }
 
 ////
-?>
\ No newline at end of file
+?>
