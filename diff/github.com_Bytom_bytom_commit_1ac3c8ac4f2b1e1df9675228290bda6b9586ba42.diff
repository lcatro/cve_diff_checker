From 1ac3c8ac4f2b1e1df9675228290bda6b9586ba42 Mon Sep 17 00:00:00 2001
From: yahtoo <yahtoo.ma@gmail.com>
Date: Fri, 31 Aug 2018 13:48:40 +0800
Subject: [PATCH] p2p/discv5: fix idx can be negative after uint convert to
 int(can cause crash) (#1307)

---
 p2p/discover/net.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/p2p/discover/net.go b/p2p/discover/net.go
index a6319d890..3645860fa 100644
--- a/p2p/discover/net.go
+++ b/p2p/discover/net.go
@@ -1221,7 +1221,7 @@ func (net *Network) checkTopicRegister(data *topicRegister) (*pong, error) {
 	if hash != pongpkt.data.(*pong).TopicHash {
 		return nil, errors.New("topic hash mismatch")
 	}
-	if data.Idx < 0 || int(data.Idx) >= len(data.Topics) {
+	if int(data.Idx) < 0 || int(data.Idx) >= len(data.Topics) {
 		return nil, errors.New("topic index out of range")
 	}
 	return pongpkt.data.(*pong), nil
