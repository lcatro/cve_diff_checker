From ca3356eb49fee03e2eaf6b6aff826988c1122d93 Mon Sep 17 00:00:00 2001
From: Jason Summers <jason1@pobox.com>
Date: Fri, 14 Apr 2017 11:30:33 -0400
Subject: [PATCH] Fixed a GIF decoding bug (divide by zero)

Fixes issue #15
---
 src/imagew-gif.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/imagew-gif.c b/src/imagew-gif.c
index 7847c55..671fd4c 100644
--- a/src/imagew-gif.c
+++ b/src/imagew-gif.c
@@ -614,6 +614,10 @@ static int iwgif_read_image(struct iwgifrcontext *rctx)
 
 	rctx->image_width = (int)iw_get_ui16le(&rctx->rbuf[4]);
 	rctx->image_height = (int)iw_get_ui16le(&rctx->rbuf[6]);
+	if(rctx->image_width<1 || rctx->image_height<1) {
+		iw_set_error(rctx->ctx, "Invalid image dimensions");
+		goto done;
+	}
 
 	rctx->interlaced = (int)((rctx->rbuf[8]>>6)&0x01);
 
