From 6b2212b2ce152c19538a2431415f72942c5a1bde Mon Sep 17 00:00:00 2001
From: Michael Iwersen <michael.iwersen@zalando.de>
Date: Sat, 19 Dec 2020 20:51:19 +0100
Subject: [PATCH] Fixed 2nd issue with prototype pollution

---
 README.md                         | 6 ++++++
 package.json                      | 2 +-
 src/parser.js                     | 2 +-
 test/data/prototype_pollution.ini | 6 +++++-
 4 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/README.md b/README.md
index 42b9433..c36f7ec 100644
--- a/README.md
+++ b/README.md
@@ -137,6 +137,12 @@ content = serializer.serialize({
 
 ## Changelog
 
+### 2.1.2
+* Fixed prototype pollution by ignoring `constructor`
+
+### 2.1.1
+* Fixed prototype pollution by ignoring `__proto__`
+
 ### 1.0.1
 * Fixed bug with `keep_quotes` ignored when writing files
 
diff --git a/package.json b/package.json
index 14c5ea9..4614dc1 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "multi-ini",
-  "version": "2.1.1",
+  "version": "2.1.2",
   "license": "MIT",
   "description": "An ini-file parser which supports multi line, multiple levels and arrays to get a maximum of compatibility with Zend config files.",
   "main": "lib/index.js",
diff --git a/src/parser.js b/src/parser.js
index 980b826..99338d9 100644
--- a/src/parser.js
+++ b/src/parser.js
@@ -20,7 +20,7 @@ const defaults = {
     constants: {},
 };
 
-const REGEXP_IGNORE_KEYS = /__proto__/;
+const REGEXP_IGNORE_KEYS = /__proto__|constructor|prototype/;
 
 class Parser {
     constructor(options = {}) {
diff --git a/test/data/prototype_pollution.ini b/test/data/prototype_pollution.ini
index a235af3..62e5479 100644
--- a/test/data/prototype_pollution.ini
+++ b/test/data/prototype_pollution.ini
@@ -3,4 +3,8 @@ value=key
 [__proto__]
 polluted="polluted"
 [other]
-__proto__.path_polluted="polluted"
\ No newline at end of file
+__proto__.path_polluted="polluted"
+[constructor]
+prototype.polluted = polluted
+[prototype]
+polluted = polluted
\ No newline at end of file
