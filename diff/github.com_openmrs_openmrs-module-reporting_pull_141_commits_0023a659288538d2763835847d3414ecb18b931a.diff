From 0023a659288538d2763835847d3414ecb18b931a Mon Sep 17 00:00:00 2001
From: Isaac Sears <isaac.j.sears@gmail.com>
Date: Tue, 18 Apr 2017 20:15:15 +0000
Subject: [PATCH] Patch XSS in reporting

---
 omod/src/main/webapp/portlets/baseMetadata.jsp | 4 ++--
 omod/src/main/webapp/reports/manageReports.jsp | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/omod/src/main/webapp/portlets/baseMetadata.jsp b/omod/src/main/webapp/portlets/baseMetadata.jsp
index f2ac625dd..14e5fe7cb 100644
--- a/omod/src/main/webapp/portlets/baseMetadata.jsp
+++ b/omod/src/main/webapp/portlets/baseMetadata.jsp
@@ -42,7 +42,7 @@
 			<div style="margin:0; padding:0; width:100%;">
 				<div class="metadataField">
 					<label class="desc" for="name"><spring:message code="reporting.name" /></label>
-					<input type="text" id="name" tabindex="1" name="name" value="${model.obj.name}" size="50"/>
+					<input type="text" id="name" tabindex="1" name="name" value="<c:out value='${model.obj.name}' />" size="50"/>
 				</div>
 				<c:if test="${!empty model.obj && model.showType != 'false'}">
 					<div class="metadataField">
@@ -52,7 +52,7 @@
 				</c:if>		
 				<div class="metadataField">
 					<label class="desc" for="description"><spring:message code="reporting.description" /></label>			
-					<textarea id="description" cols="80" rows="10" tabindex="2" name="description">${model.obj.description}</textarea>
+					<textarea id="description" cols="80" rows="10" tabindex="2" name="description"><c:out value='${model.obj.description}' /></textarea>
 				</div>
 			</div>
 			<hr style="color:blue;"/>
diff --git a/omod/src/main/webapp/reports/manageReports.jsp b/omod/src/main/webapp/reports/manageReports.jsp
index d355a5159..bb6c80277 100644
--- a/omod/src/main/webapp/reports/manageReports.jsp
+++ b/omod/src/main/webapp/reports/manageReports.jsp
@@ -73,7 +73,7 @@
 							<rpt:displayLabel type="${reportDefinition['class'].name}"/>
 						</td>
 						<td width="5%" nowrap>
-							${reportDefinition.creator}
+							<c:out value="${reportDefinition.creator}" />
 						</td>
 						<td width="5%" nowrap>
 							<rpt:timespan then="${reportDefinition.dateCreated}"/>
@@ -82,7 +82,7 @@
 							&nbsp;
 							<a href="${editUrl}"><img src="<c:url value='/images/edit.gif'/>" border="0"/></a>
 							&nbsp;
-							<a href="javascript:confirmDelete('${reportDefinition.name}','${reportDefinition.uuid}');"><img src="<c:url value='/images/trash.gif'/>" border="0"/></a>
+							<a href="javascript:confirmDelete('<c:out value="${openmrs:getSafeJsString(reportDefinition.name)}" />','${reportDefinition.uuid}');"><img src="<c:url value='/images/trash.gif'/>" border="0"/></a>
 							&nbsp;
 							<a href="${pageContext.request.contextPath}/module/reporting/run/runReport.form?reportId=${reportDefinition.uuid}">
 								<img src='<c:url value="/images/play.gif"/>' align="absmiddle" border="0"/>
