From ec7d74a386c0b2f38990079c3b0d2a2b30be0e71 Mon Sep 17 00:00:00 2001
From: Jay Berkenbilt <ejb@ql.org>
Date: Mon, 28 Aug 2017 22:25:45 -0400
Subject: [PATCH] Add test case for overflow in PNG filter (fixes #150)

---
 qpdf/qtest/qpdf.test          |   1 +
 qpdf/qtest/qpdf/issue-150.out |   2 ++
 qpdf/qtest/qpdf/issue-150.pdf | Bin 0 -> 137 bytes
 3 files changed, 3 insertions(+)
 create mode 100644 qpdf/qtest/qpdf/issue-150.out
 create mode 100644 qpdf/qtest/qpdf/issue-150.pdf

diff --git a/qpdf/qtest/qpdf.test b/qpdf/qtest/qpdf.test
index 5a28a91b..2fc7f63a 100644
--- a/qpdf/qtest/qpdf.test
+++ b/qpdf/qtest/qpdf.test
@@ -225,6 +225,7 @@ my @bug_tests = (
     ["147", "previously caused memory error", 2],
     ["148", "free memory on bad flate", 2],
     ["149", "xref prev pointer loop", 3],
+    ["150", "integer overflow", 2],
     );
 $n_tests += scalar(@bug_tests);
 foreach my $d (@bug_tests)
diff --git a/qpdf/qtest/qpdf/issue-150.out b/qpdf/qtest/qpdf/issue-150.out
new file mode 100644
index 00000000..862b4d1e
--- /dev/null
+++ b/qpdf/qtest/qpdf/issue-150.out
@@ -0,0 +1,2 @@
+WARNING: issue-150.pdf: can't find PDF header
+overflow/underflow converting 9900000000000000000 to 64-bit integer
diff --git a/qpdf/qtest/qpdf/issue-150.pdf b/qpdf/qtest/qpdf/issue-150.pdf
new file mode 100644
index 0000000000000000000000000000000000000000..c9ce992d4b3b972b749d42bd290b86343d9cae31
GIT binary patch
literal 137
zcmY+7K?=e!5CHFa#r|N|;-Q6-i_&wc1qJaClPyG&Mm7<uZ}G9_>YQg7BBB-u(*4o*
zIKQ8amx&h~d?+k91U#}$jz=RgSL2YvE3O&3u7>~MDD1o~NnqD#jpr*t19Zca|1gl&
Wxd@x6wyz~#T|KH?jFe4yQTrbZ?kXVw

literal 0
HcmV?d00001

