From 67a9c2f0229de120431f3eecb0f5017075517105 Mon Sep 17 00:00:00 2001
From: dleffler <dleffler@hughes.net>
Date: Mon, 27 Apr 2020 16:34:18 -0400
Subject: [PATCH] fix sql injection issue

---
 framework/modules/eaas/controllers/eaasController.php | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/framework/modules/eaas/controllers/eaasController.php b/framework/modules/eaas/controllers/eaasController.php
index b836ff0560..1512a55ad2 100644
--- a/framework/modules/eaas/controllers/eaasController.php
+++ b/framework/modules/eaas/controllers/eaasController.php
@@ -80,6 +80,8 @@ public function api() {
             $ar->send();  //FIXME this doesn't seem to work correctly in this scenario
         } else {
             $key = expUnserialize(base64_decode(urldecode($this->params['apikey'])));
+            preg_match('/[^a-zA-Z_][^a-zA-Z0-9_]*/', $key, $matches);
+            $key = $matches[0];
             $cfg = new expConfig($key);
             $this->config = $cfg->config;
             if(empty($cfg->id)) {
