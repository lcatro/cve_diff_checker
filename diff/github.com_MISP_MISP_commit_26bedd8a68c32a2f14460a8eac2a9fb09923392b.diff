From 26bedd8a68c32a2f14460a8eac2a9fb09923392b Mon Sep 17 00:00:00 2001
From: mokaddem <sami.mokaddem@circl.lu>
Date: Sat, 27 Jul 2019 10:40:19 +0200
Subject: [PATCH] fix: [security] Fix to stored XSS

- as reported by David Heise
---
 app/webroot/js/event-graph.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/app/webroot/js/event-graph.js b/app/webroot/js/event-graph.js
index 19586d12dd..80228639c6 100644
--- a/app/webroot/js/event-graph.js
+++ b/app/webroot/js/event-graph.js
@@ -2183,7 +2183,10 @@ eventGraph.update_scope();
 dataHandler.fetch_data_and_update(true, function() {
     var $select = $('#network-typeahead');
     dataHandler.get_typeaheadData_search().forEach(function(element) {
-        $select.append('<option value="' + element + '">' + element + '</option>');
+        var $option = $('<option></option>');
+        $option.text(element);
+        $option.attr('value', $option.text());
+        $select.append($option);
     });
     $('#network-typeahead').chosen(chosen_options).on('change', function(evt, params) {
         var value = params.selected;
