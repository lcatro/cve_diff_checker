From 00cfae5661124f9d67ac6733db61b2bfee34dccc Mon Sep 17 00:00:00 2001
From: peterdd <ddpm@liscovius.de>
Date: Wed, 13 Sep 2017 00:25:27 +0200
Subject: [PATCH] quickfix for dokuwiki links

---
 plugins/dokuwiki/lib/plugins/changelinks/syntax.php | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

diff --git a/plugins/dokuwiki/lib/plugins/changelinks/syntax.php b/plugins/dokuwiki/lib/plugins/changelinks/syntax.php
index 7a733b37e..263e0661f 100644
--- a/plugins/dokuwiki/lib/plugins/changelinks/syntax.php
+++ b/plugins/dokuwiki/lib/plugins/changelinks/syntax.php
@@ -130,8 +130,15 @@ function render($mode, &$renderer, $data) {
             $link['more']   = '';
             $link['class']  = 'internallink';
             $link['url']    = DOKU_INTERNAL_LINK . $id;
-            $link['name']   = ($name) ? $name : $id;
-            $link['title']  = ($name) ? $name : $id;
+         
+            if(is_array($name)){
+               $link['name']   = (isset($name['title'])) ? hsc($name['title']) : hsc($id);
+               $link['title'] = $id;
+            } else{
+               $link['name']   = ($name) ? hsc($name) : hsc($id);
+               $link['title'] = ($name) ? $name : $id;
+            }
+
             //add search string
             if($search){
                 ($conf['userewrite']) ? $link['url'].='?s=' : $link['url'].='&amp;s=';
@@ -147,4 +154,4 @@ function render($mode, &$renderer, $data) {
 }
  
 //Setup VIM: ex: et ts=4 enc=utf-8 :
-?>
\ No newline at end of file
+?>
