From 8e5d14ec60e0c1847a4733556cf34d232c27102c Mon Sep 17 00:00:00 2001
From: Oscar Rodriguez <orsalido@minsait.com>
Date: Thu, 8 Oct 2020 11:22:28 +0200
Subject: [PATCH] *Code fix

---
 .../features/worker/FakeInfectionReportWorker.kt          | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

diff --git a/app/src/main/java/es/gob/radarcovid/features/worker/FakeInfectionReportWorker.kt b/app/src/main/java/es/gob/radarcovid/features/worker/FakeInfectionReportWorker.kt
index a34be4b4..14462c19 100644
--- a/app/src/main/java/es/gob/radarcovid/features/worker/FakeInfectionReportWorker.kt
+++ b/app/src/main/java/es/gob/radarcovid/features/worker/FakeInfectionReportWorker.kt
@@ -20,7 +20,7 @@ import org.dpppt.android.sdk.DP3T
 import java.security.SecureRandom
 import java.util.concurrent.TimeUnit
 import javax.inject.Inject
-
+import kotlin.math.ln
 
 private const val FACTOR_HOUR_MILLIS = 60 * 60 * 1000L
 private const val FACTOR_DAY_MILLIS: Long = 24 * FACTOR_HOUR_MILLIS
@@ -78,8 +78,6 @@ class FakeInfectionReportWorker(context: Context, workerParams: WorkerParameters
                 .enqueueUniqueWork(TAG, existingWorkPolicy, work)
         }
 
-        //private fun getRandomDelay(): Long = Random.nextLong(180, 360)
-
     }
 
     @Inject
@@ -114,7 +112,7 @@ class FakeInfectionReportWorker(context: Context, workerParams: WorkerParameters
         override fun syncInterval(): Long {
             val newDelayDays: Double =
                 ExponentialDistribution.sampleFromStandard() / SAMPLING_RATE
-            return (newDelayDays * FACTOR_DAY_MILLIS) as Long
+            return (newDelayDays * FACTOR_DAY_MILLIS).toLong()
         }
 
         override fun currentTimeMillis(): Long {
@@ -125,7 +123,7 @@ class FakeInfectionReportWorker(context: Context, workerParams: WorkerParameters
     object ExponentialDistribution {
         fun sampleFromStandard(): Double {
             val random = SecureRandom()
-            return -Math.log(1.0 - random.nextDouble())
+            return -ln(1.0 - random.nextDouble())
         }
     }
 
