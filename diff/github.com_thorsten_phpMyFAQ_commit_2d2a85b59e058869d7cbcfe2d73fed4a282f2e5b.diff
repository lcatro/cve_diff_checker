From 2d2a85b59e058869d7cbcfe2d73fed4a282f2e5b Mon Sep 17 00:00:00 2001
From: Thorsten Rinne <thorsten@phpmyfaq.de>
Date: Tue, 10 Oct 2017 16:48:34 +0200
Subject: [PATCH] Fixed possible admin XSS attack vector

---
 phpmyfaq/admin/configuration.php | 3 ++-
 phpmyfaq/index.php               | 4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/phpmyfaq/admin/configuration.php b/phpmyfaq/admin/configuration.php
index e376a8002f..6a6b692311 100644
--- a/phpmyfaq/admin/configuration.php
+++ b/phpmyfaq/admin/configuration.php
@@ -50,7 +50,8 @@
             'main.contactInformations',
             'main.customPdfHeader',
             'main.customPdfFooter',
-            'main.titleFAQ'
+            'main.titleFAQ',
+            'main.metaKeywords'
         ];
 
         // Special checks
diff --git a/phpmyfaq/index.php b/phpmyfaq/index.php
index 5aa75d71cb..a05f51ba4b 100755
--- a/phpmyfaq/index.php
+++ b/phpmyfaq/index.php
@@ -484,8 +484,8 @@
     'version' => $faqConfig->get('main.currentVersion'),
     'header' => PMF_String::htmlspecialchars(str_replace('"', '', $faqConfig->get('main.titleFAQ'))),
     'metaTitle' => PMF_String::htmlspecialchars(str_replace('"', '', $faqConfig->get('main.titleFAQ').$title)),
-    'metaDescription' => $metaDescription,
-    'metaKeywords' => $keywords,
+    'metaDescription' => PMF_String::htmlspecialchars($metaDescription),
+    'metaKeywords' => PMF_String::htmlspecialchars($keywords),
     'metaPublisher' => $faqConfig->get('main.metaPublisher'),
     'metaLanguage' => $PMF_LANG['metaLanguage'],
     'metaCharset' => 'utf-8', // backwards compability
