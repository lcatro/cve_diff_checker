From d692d67332bcc90540088ad8e725eb3279e39863 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 22 Mar 2017 16:02:48 -0700
Subject: [PATCH] CVE-2017-13020/VTP: Add another test.

A capture file supplied by Bhargava Shastry, modified so the capture
file won't be rejected as an invalid capture.
---
 tests/TESTLIST        |   1 +
 tests/vtp_asan-2.out  |   3 +++
 tests/vtp_asan-2.pcap | Bin 0 -> 108 bytes
 3 files changed, 4 insertions(+)
 create mode 100644 tests/vtp_asan-2.out
 create mode 100644 tests/vtp_asan-2.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index fdcd593c6..388dcfe8a 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -523,6 +523,7 @@ pgm_opts_asan		pgm_opts_asan.pcap		pgm_opts_asan.out	-v
 pgm_opts_asan_2		pgm_opts_asan_2.pcap		pgm_opts_asan_2.out	-v
 pgm_opts_asan_3		pgm_opts_asan_3.pcap		pgm_opts_asan_3.out	-v
 vtp_asan		vtp_asan.pcap			vtp_asan.out	-v
+vtp_asan-2		vtp_asan-2.pcap			vtp_asan-2.out	-v
 icmp6_mobileprefix_asan	icmp6_mobileprefix_asan.pcap	icmp6_mobileprefix_asan.out	-v
 ip_printroute_asan	ip_printroute_asan.pcap		ip_printroute_asan.out	-v
 mobility_opt_asan	mobility_opt_asan.pcap		mobility_opt_asan.out	-v
diff --git a/tests/vtp_asan-2.out b/tests/vtp_asan-2.out
new file mode 100644
index 000000000..32c319da7
--- /dev/null
+++ b/tests/vtp_asan-2.out
@@ -0,0 +1,3 @@
+FRF.16 Frag, seq 193, Flags [Begin, End], UI 08! VTPv69, Message Subset advertisement (0x02), length 2126400013
+	Domain name: , Seq number: 0, Config Rev fb499603
+	VLAN info status Unknown, type TrCRF, VLAN-id 256, MTU 771, SAID 0x03030303, Name ^C^I^C[|vtp]
diff --git a/tests/vtp_asan-2.pcap b/tests/vtp_asan-2.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..31a9f5e1a262d612e6c433e801260ac09743d9e5
GIT binary patch
literal 108
zcmca|c+)~A1{Q{GDZ&34fWQTaw*hg=oQPCr27v|;U&?D=-GPG#`r6_-8W<RO6qsF^
z7$g|x@;_i$D+m-|2%C1`^?zyc|Ete3F*5O8|Ihrt{y+C`&uPpcz{mimn3*}50pF}1
A-2eap

literal 0
HcmV?d00001

