From 732f1647cc6e0a29b5b1f5d904b4d726b5e9455f Mon Sep 17 00:00:00 2001
From: Bernhard Rusch <bernhard.rusch@elements.at>
Date: Tue, 19 Mar 2019 14:56:35 +0100
Subject: [PATCH] [Asset] do not allow filenames longer than 255 characters

---
 models/Asset.php | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/models/Asset.php b/models/Asset.php
index f43fd585aca..4d28af150f2 100644
--- a/models/Asset.php
+++ b/models/Asset.php
@@ -623,6 +623,10 @@ public function correctPath()
             $this->setFilename($this->getFilename() . '.txt');
         }
 
+        if(mb_strlen($this->getFilename()) > 255) {
+            throw new \Exception('Filenames longer than 255 characters are not allowed');
+        }
+
         if (Asset\Service::pathExists($this->getRealFullPath())) {
             $duplicate = Asset::getByPath($this->getRealFullPath());
             if ($duplicate instanceof Asset and $duplicate->getId() != $this->getId()) {
