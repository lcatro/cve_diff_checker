From 303fa88fe664ded4bf8753b997abd916f0a3c03f Mon Sep 17 00:00:00 2001
From: James Allsup <james@allsup.eu>
Date: Thu, 17 Dec 2015 23:59:08 +0000
Subject: [PATCH] Fixed low risk XSS issue with user account address edit.
 Thanks to @robert81 for the find.

Close #3721
---
 upload/catalog/controller/account/address.php | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/upload/catalog/controller/account/address.php b/upload/catalog/controller/account/address.php
index 1f2cb921689..a84f99fdaa7 100644
--- a/upload/catalog/controller/account/address.php
+++ b/upload/catalog/controller/account/address.php
@@ -425,7 +425,7 @@ protected function getForm() {
 		}
 
 		if (isset($this->request->post['country_id'])) {
-			$data['country_id'] = $this->request->post['country_id'];
+			$data['country_id'] = (int)$this->request->post['country_id'];
 		}  elseif (!empty($address_info)) {
 			$data['country_id'] = $address_info['country_id'];
 		} else {
@@ -433,7 +433,7 @@ protected function getForm() {
 		}
 
 		if (isset($this->request->post['zone_id'])) {
-			$data['zone_id'] = $this->request->post['zone_id'];
+			$data['zone_id'] = (int)$this->request->post['zone_id'];
 		}  elseif (!empty($address_info)) {
 			$data['zone_id'] = $address_info['zone_id'];
 		} else {
@@ -503,11 +503,11 @@ protected function validateForm() {
 			$this->error['postcode'] = $this->language->get('error_postcode');
 		}
 
-		if ($this->request->post['country_id'] == '') {
+		if ($this->request->post['country_id'] == '' || !is_int($this->request->post['country_id'])) {
 			$this->error['country'] = $this->language->get('error_country');
 		}
 
-		if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '') {
+		if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_int($this->request->post['zone_id'])) {
 			$this->error['zone'] = $this->language->get('error_zone');
 		}
 
