From 1cc1adad2de03a0f013881b8960daf89aa155081 Mon Sep 17 00:00:00 2001
From: Dimitri van Heesch <dimitri@stack.nl>
Date: Fri, 25 Mar 2016 19:55:20 +0100
Subject: [PATCH] Bug 762934 - External search does not properly escape user
 supplied data, resulting in vulnerability

---
 templates/html/search_opensearch.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/templates/html/search_opensearch.php b/templates/html/search_opensearch.php
index e3a463439b..58ee4ab260 100644
--- a/templates/html/search_opensearch.php
+++ b/templates/html/search_opensearch.php
@@ -3,6 +3,7 @@
 
 $mode = array_key_exists('v', $_GET)?$_GET['v']:"";
 $query = array_key_exists('query', $_GET)?$_GET['query']:"";
+$query = preg_replace("/[^a-zA-Z0-9\-\_\.\x80-\xFF]/i", " ", $query );
 
 $query_results = run_query($query);
 
