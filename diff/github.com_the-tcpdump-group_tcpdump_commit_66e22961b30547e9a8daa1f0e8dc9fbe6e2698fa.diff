From 66e22961b30547e9a8daa1f0e8dc9fbe6e2698fa Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 22 Mar 2017 15:59:23 -0700
Subject: [PATCH] CVE-2017-13028/BOOTP: Add another test.

A capture file supplied by Bhargava Shastry, modified so the capture
file won't be rejected as an invalid capture.
---
 tests/TESTLIST          |   1 +
 tests/bootp_asan-2.out  |   2 ++
 tests/bootp_asan-2.pcap | Bin 0 -> 93 bytes
 3 files changed, 3 insertions(+)
 create mode 100644 tests/bootp_asan-2.out
 create mode 100644 tests/bootp_asan-2.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 314afa223..fdcd593c6 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -536,6 +536,7 @@ isis_stlv_asan-3	isis_stlv_asan-3.pcap		isis_stlv_asan-3.out	-v
 isis_stlv_asan-4	isis_stlv_asan-4.pcap		isis_stlv_asan-4.out	-v
 lldp_mgmt_addr_tlv_asan	lldp_mgmt_addr_tlv_asan.pcap	lldp_mgmt_addr_tlv_asan.out	-v
 bootp_asan		bootp_asan.pcap			bootp_asan.out		-v
+bootp_asan-2		bootp_asan-2.pcap		bootp_asan-2.out	-v
 ppp_ccp_config_deflate_option_asan	ppp_ccp_config_deflate_option_asan.pcap	ppp_ccp_config_deflate_option_asan.out	-v
 pim_header_asan		pim_header_asan.pcap		pim_header_asan.out	-v
 pim_header_asan-2	pim_header_asan-2.pcap		pim_header_asan-2.out	-v
diff --git a/tests/bootp_asan-2.out b/tests/bootp_asan-2.out
new file mode 100644
index 000000000..d3ae8d99a
--- /dev/null
+++ b/tests/bootp_asan-2.out
@@ -0,0 +1,2 @@
+IP (tos 0x0, ttl 252, id 40207, offset 0, flags [+, DF, rsvd], proto UDP (17), length 60951, bad cksum ff (->8336)!)
+    18.0.0.15.16896 > 107.95.83.32.68: BOOTP/DHCP, unknown (0x00), length 59384, htype 0, hlen 0, hops 13, xid 0x14000000, secs 3328 [|bootp]
diff --git a/tests/bootp_asan-2.pcap b/tests/bootp_asan-2.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..a79941f320280cb0ec38509fbb2e4007ed2ca095
GIT binary patch
literal 93
zcmca|c+)~A1{MY&U<DDTK+FhYKmmxa1QOx-?K!RP!2kaZ40AacTp8Yp&*gu>@JEp0
czYqfhe|CJZf)fLS%L@ip5ugTMFv0L205cO3zW@LL

literal 0
HcmV?d00001

