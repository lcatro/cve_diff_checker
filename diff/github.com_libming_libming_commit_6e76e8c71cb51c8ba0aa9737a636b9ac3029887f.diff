From 6e76e8c71cb51c8ba0aa9737a636b9ac3029887f Mon Sep 17 00:00:00 2001
From: Young Xiao <YangX92@hotmail.com>
Date: Sat, 16 Mar 2019 17:27:18 +0800
Subject: [PATCH] SWFShape_setLeftFillStyle: prevent fill overflow

---
 src/blocks/shape.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/blocks/shape.c b/src/blocks/shape.c
index 67c81dcf..cfab7bca 100644
--- a/src/blocks/shape.c
+++ b/src/blocks/shape.c
@@ -1169,6 +1169,11 @@ SWFShape_setLeftFillStyle(SWFShape shape, SWFFillStyle fill)
 			return;		
 		idx = getFillIdx(shape, fill);
 	}
+	else if (idx >= 255 && shape->useVersion == SWF_SHAPE1)
+	{
+		SWF_error("Too many fills for SWFShape V1.\n" 
+			  "Use a higher SWFShape version\n");
+	}
 				
 	record = addStyleRecord(shape);
 	record.record.stateChange->leftFill = idx;
