From 30b22b6b0db7b73732a5da346afca66dc244e02a Mon Sep 17 00:00:00 2001
From: jim-p <jimp@netgate.com>
Date: Thu, 31 Oct 2019 08:28:28 -0400
Subject: [PATCH] Encode FreeRADIUS config file display output. Fixes #9866

---
 net/pfSense-pkg-freeradius3/Makefile                            | 2 +-
 .../files/usr/local/www/freeradius_view_config.php              | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/net/pfSense-pkg-freeradius3/Makefile b/net/pfSense-pkg-freeradius3/Makefile
index 7d5c3a9de36e..66777a8902e6 100644
--- a/net/pfSense-pkg-freeradius3/Makefile
+++ b/net/pfSense-pkg-freeradius3/Makefile
@@ -2,7 +2,7 @@
 
 PORTNAME=	pfSense-pkg-freeradius3
 PORTVERSION=	0.15.7
-PORTREVISION=	2
+PORTREVISION=	3
 CATEGORIES=	net
 MASTER_SITES=	# empty
 DISTFILES=	# empty
diff --git a/net/pfSense-pkg-freeradius3/files/usr/local/www/freeradius_view_config.php b/net/pfSense-pkg-freeradius3/files/usr/local/www/freeradius_view_config.php
index 625415d7884c..a88f3be7cd50 100644
--- a/net/pfSense-pkg-freeradius3/files/usr/local/www/freeradius_view_config.php
+++ b/net/pfSense-pkg-freeradius3/files/usr/local/www/freeradius_view_config.php
@@ -40,7 +40,7 @@ function get_file($file) {
 
 	if ($files[$file] != "" && file_exists($files[$file])) {
 		print '<pre>';
-		print $files[$file] . "\n" . file_get_contents($files[$file]);
+		print $files[$file] . "\n" . htmlspecialchars(file_get_contents($files[$file]));
 		print '</pre>';
 	}
 }
