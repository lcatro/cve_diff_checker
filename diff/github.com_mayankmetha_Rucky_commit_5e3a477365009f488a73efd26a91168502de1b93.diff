From 5e3a477365009f488a73efd26a91168502de1b93 Mon Sep 17 00:00:00 2001
From: mayankmetha <mayankmethad@gmail.com>
Date: Sat, 25 Sep 2021 16:34:34 +0530
Subject: [PATCH] Fix security vulnerabilities

---
 .../main/java/com/mayank/rucky/activity/ConfigActivity.java | 4 ++--
 app/src/main/java/com/mayank/rucky/utils/Constants.java     | 6 ------
 app/src/main/java/com/mayank/rucky/utils/Randoms.java       | 6 +++---
 3 files changed, 5 insertions(+), 11 deletions(-)

diff --git a/app/src/main/java/com/mayank/rucky/activity/ConfigActivity.java b/app/src/main/java/com/mayank/rucky/activity/ConfigActivity.java
index 030d641..6dd092a 100644
--- a/app/src/main/java/com/mayank/rucky/activity/ConfigActivity.java
+++ b/app/src/main/java/com/mayank/rucky/activity/ConfigActivity.java
@@ -140,8 +140,8 @@ private void updateStatus() {
         if (config.getHIDMode() == 0) {
             config.setNetworkStatus(false);
             EditorActivity.stopNetworkSocketService(this);
-            ipButton.setVisibility(View.GONE);
-            ipStatusDivider.setVisibility(View.GONE);
+            ipButton.setVisibility(View.INVISIBLE);
+            ipStatusDivider.setVisibility(View.INVISIBLE);
             if (config.getUSBStatus()) {
                 statusText.setText(R.string.config_status_usb_on);
                 statusImage.setImageDrawable(ContextCompat.getDrawable(this, R.drawable.ic_usb));
diff --git a/app/src/main/java/com/mayank/rucky/utils/Constants.java b/app/src/main/java/com/mayank/rucky/utils/Constants.java
index 2687fad..0d092e5 100644
--- a/app/src/main/java/com/mayank/rucky/utils/Constants.java
+++ b/app/src/main/java/com/mayank/rucky/utils/Constants.java
@@ -35,12 +35,6 @@
     public static final String PREF_HID_FILE = "hidFile";
     public static final String PREF_HID_FILE_SELECTED = "hidFileSelected";
 
-    //keystore
-    public static final String PREF_GEN_KEY = "genKeyDone";
-    public static final String KEYSTORE_PROVIDER_ANDROID_KEYSTORE = "AndroidKeyStore";
-    public static final String RUCKY_KEYSTORE = "RuckyKeystore";
-    public static final String RUCKY_KEYSTORE2 = "RuckyKeystore2";
-
     //notifications
     public static final String CHANNEL_ID = "com.mayank.rucky.update";
     public static final String CHANNEL_NAME = "Update";
diff --git a/app/src/main/java/com/mayank/rucky/utils/Randoms.java b/app/src/main/java/com/mayank/rucky/utils/Randoms.java
index 016ba9d..4b17124 100644
--- a/app/src/main/java/com/mayank/rucky/utils/Randoms.java
+++ b/app/src/main/java/com/mayank/rucky/utils/Randoms.java
@@ -1,14 +1,14 @@
 package com.mayank.rucky.utils;
 
 import java.util.Date;
-import java.util.Random;
+import java.security.SecureRandom;
 
 public class Randoms {
 
-    Random random;
+    SecureRandom random;
 
     Randoms() {
-        random = new Random();
+        random = new SecureRandom();
         Date date = new Date();
         random.setSeed(date.getTime());
     }
