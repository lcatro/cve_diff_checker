From ab07a1b447de34e13983b4d7ceb18b58c3a358d8 Mon Sep 17 00:00:00 2001
From: Jan Schneider <jan@horde.org>
Date: Wed, 6 Jan 2016 11:46:35 +0100
Subject: [PATCH] [jan] SECURITY: Fix XSS vulnerability in menu bar exposed by
 only a few applications (Bug #14213).

---
 horde/docs/CHANGES                       | 2 ++
 horde/package.xml                        | 4 ++--
 horde/templates/topbar/_menubar.html.php | 2 +-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/horde/docs/CHANGES b/horde/docs/CHANGES
index c014c41d6aa..a9fd86522e2 100644
--- a/horde/docs/CHANGES
+++ b/horde/docs/CHANGES
@@ -2,6 +2,8 @@
 v5.2.9-git
 ----------
 
+[jan] SECURITY: Fix XSS vulnerability in menu bar exposed by only a few
+      applications (Bug #14213).
 
 
 ------
diff --git a/horde/package.xml b/horde/package.xml
index 5aecf15cbf0..17b9e11ddaf 100644
--- a/horde/package.xml
+++ b/horde/package.xml
@@ -39,7 +39,7 @@
  </stability>
  <license uri="http://www.horde.org/licenses/lgpl">LGPL-2</license>
  <notes>
-* 
+* [jan] SECURITY: Fix XSS vulnerability in menu bar exposed by only a few applications (Bug #14213).
  </notes>
  <contents>
   <dir baseinstalldir="/" name="/">
@@ -4074,7 +4074,7 @@
    <date>2015-10-20</date>
    <license uri="http://www.horde.org/licenses/lgpl">LGPL-2</license>
    <notes>
-* 
+* [jan] SECURITY: Fix XSS vulnerability in menu bar exposed by only a few applications (Bug #14213).
    </notes>
   </release>
  </changelog>
diff --git a/horde/templates/topbar/_menubar.html.php b/horde/templates/topbar/_menubar.html.php
index acb416cf2e9..df75623e51c 100644
--- a/horde/templates/topbar/_menubar.html.php
+++ b/horde/templates/topbar/_menubar.html.php
@@ -23,7 +23,7 @@
         <input autocomplete="off" id="horde-search-input" type="text" />
       </div>
 <?php else: ?>
-      <input type="text" id="horde-search-input" name="searchfield" class="formGhost" title="<?php echo $this->searchLabel ?>" />
+      <input type="text" id="horde-search-input" name="searchfield" class="formGhost" title="<?php echo $this->h($this->searchLabel) ?>" />
 <?php endif ?>
       <input type="image" id="horde-search-icon" src="<?php echo $this->searchIcon ?>" />
     </form>
