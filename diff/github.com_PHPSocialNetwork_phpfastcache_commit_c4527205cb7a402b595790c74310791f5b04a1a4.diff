From c4527205cb7a402b595790c74310791f5b04a1a4 Mon Sep 17 00:00:00 2001
From: Geolim4 <contact@geolim4.com>
Date: Fri, 30 Dec 2016 09:40:00 +0100
Subject: [PATCH] Fixed critical vulnerability on cookie driver

---
 src/phpFastCache/Drivers/Cookie/Driver.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/phpFastCache/Drivers/Cookie/Driver.php b/src/phpFastCache/Drivers/Cookie/Driver.php
index d9045d7c0..9d006c535 100644
--- a/src/phpFastCache/Drivers/Cookie/Driver.php
+++ b/src/phpFastCache/Drivers/Cookie/Driver.php
@@ -99,7 +99,7 @@ protected function driverRead(CacheItemInterface $item)
         // return null if no caching
         // return value if in caching
         $keyword = self::PREFIX . $item->getKey();
-        $x = isset($_COOKIE[ $keyword ]) ? $this->decode(json_decode($_COOKIE[ $keyword ], true)) : false;
+        $x = isset($_COOKIE[ $keyword ]) ? json_decode($_COOKIE[ $keyword ], true) : false;
 
         if ($x == false) {
             return null;
