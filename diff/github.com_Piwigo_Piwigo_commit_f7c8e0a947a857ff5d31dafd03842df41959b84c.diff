From f7c8e0a947a857ff5d31dafd03842df41959b84c Mon Sep 17 00:00:00 2001
From: plegall <plg@piwigo.org>
Date: Mon, 18 Dec 2017 16:45:56 +0100
Subject: [PATCH] (cp 9028c75) fixes #825, check user input on Batch Manager,
 unit mode, to prevent SQL injection

---
 admin/batch_manager_unit.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/admin/batch_manager_unit.php b/admin/batch_manager_unit.php
index 2e44752628..d417c62f7e 100644
--- a/admin/batch_manager_unit.php
+++ b/admin/batch_manager_unit.php
@@ -47,6 +47,7 @@
 
 if (isset($_POST['submit']))
 {
+  check_input_parameter('element_ids', $_POST, false, '/^\d+(,\d+)*$/');
   $collection = explode(',', $_POST['element_ids']);
 
   $datas = array();
