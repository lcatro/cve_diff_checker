From 780bd0e8fbf2d36ada52edb769477e0a4edae580 Mon Sep 17 00:00:00 2001
From: Daniel Vaz Gaspar <danielvazgaspar@gmail.com>
Date: Mon, 10 May 2021 09:37:55 +0100
Subject: [PATCH] fix: auth balance (#1634)

---
 flask_appbuilder/security/manager.py | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/flask_appbuilder/security/manager.py b/flask_appbuilder/security/manager.py
index f837e5c43..7154dc50c 100644
--- a/flask_appbuilder/security/manager.py
+++ b/flask_appbuilder/security/manager.py
@@ -833,6 +833,12 @@ def auth_user_db(self, username, password):
         if user is None:
             user = self.find_user(email=username)
         if user is None or (not user.is_active):
+            # Balance failure and success
+            check_password_hash(
+                "pbkdf2:sha256:150000$Z3t6fmj2$22da622d94a1f8118"
+                "c0976a03d2f18f680bfff877c9a965db9eedc51bc0be87c",
+                "password",
+            )
             log.info(LOGMSG_WAR_SEC_LOGIN_FAILED.format(username))
             return None
         elif check_password_hash(user.password, password):
