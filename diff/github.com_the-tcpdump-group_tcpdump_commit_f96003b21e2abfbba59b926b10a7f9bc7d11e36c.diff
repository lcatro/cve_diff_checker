From f96003b21e2abfbba59b926b10a7f9bc7d11e36c Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Sun, 5 Mar 2017 11:28:45 -0800
Subject: [PATCH] CVE-2017-12899/DECnet: Add another test.

This is from Brian Carpenter for the print-decnet bug fix.
---
 tests/TESTLIST                  |   1 +
 tests/decnet-shorthdr-oobr.out  |  29 +++++++++++++++++++++++++++++
 tests/decnet-shorthdr-oobr.pcap | Bin 0 -> 911 bytes
 3 files changed, 30 insertions(+)
 create mode 100644 tests/decnet-shorthdr-oobr.out
 create mode 100644 tests/decnet-shorthdr-oobr.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index cf6d2a683..9e7b0796e 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -436,6 +436,7 @@ ipv6-next-header-oobr-1	ipv6-next-header-oobr-1.pcap	ipv6-next-header-oobr-1.out
 ipv6-next-header-oobr-2	ipv6-next-header-oobr-2.pcap	ipv6-next-header-oobr-2.out
 ipv6-rthdr-oobr		ipv6-rthdr-oobr.pcap		ipv6-rthdr-oobr.out
 ieee802.11_tim_ie_oobr	ieee802.11_tim_ie_oobr.pcap	ieee802.11_tim_ie_oobr.out
+decnet-shorthdr-oobr	decnet-shorthdr-oobr.pcap	decnet-shorthdr-oobr.out
 
 # bad packets from Kamil Frankowicz
 snmp-heapoverflow-1	snmp-heapoverflow-1.pcap	snmp-heapoverflow-1.out
diff --git a/tests/decnet-shorthdr-oobr.out b/tests/decnet-shorthdr-oobr.out
new file mode 100644
index 000000000..b8f5578a3
--- /dev/null
+++ b/tests/decnet-shorthdr-oobr.out
@@ -0,0 +1,29 @@
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+30:30:30:30:30:30 > 30:30:30:30:30:30, ethertype Unknown (0x3030), length 808464432: 
+	0x0000:  3030 3030                                0000
+[|decnet]
diff --git a/tests/decnet-shorthdr-oobr.pcap b/tests/decnet-shorthdr-oobr.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..0af98f6a7f5dc88a93aa1b3a953fbdf42109b8d4
GIT binary patch
literal 911
zcmca|c+)~A1{MYbC=g;`U|?i`a}A7ue3%@0^r#7taHBjNB#Dg+1!5IKV^o<$^+0X%
hq-n7wO*#IQMxxzHB->4SR2g8gGlAK_pb5Xv3;^+oqM!f(

literal 0
HcmV?d00001

