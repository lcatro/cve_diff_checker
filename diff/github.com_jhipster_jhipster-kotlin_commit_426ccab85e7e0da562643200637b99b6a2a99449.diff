From 426ccab85e7e0da562643200637b99b6a2a99449 Mon Sep 17 00:00:00 2001
From: Frederik Hahne <atomfrede@gmail.com>
Date: Wed, 6 May 2020 22:18:48 +0200
Subject: [PATCH] prevent log forging when doing password reset init request

---
 .../src/main/kotlin/package/web/rest/AccountResource.kt.ejs   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/generators/server/templates/src/main/kotlin/package/web/rest/AccountResource.kt.ejs b/generators/server/templates/src/main/kotlin/package/web/rest/AccountResource.kt.ejs
index cd58f531..28643482 100644
--- a/generators/server/templates/src/main/kotlin/package/web/rest/AccountResource.kt.ejs
+++ b/generators/server/templates/src/main/kotlin/package/web/rest/AccountResource.kt.ejs
@@ -406,7 +406,7 @@ class AccountResource(
         } else {
             // Pretend the request has been successful to prevent checking which emails really exist
             // but log that an invalid attempt has been made
-            log.warn("Password reset requested for non existing mail '$mail'");
+            log.warn("Password reset requested for non existing mail");
         }
     }
     <%_ } else { _%>
@@ -418,7 +418,7 @@ class AccountResource(
                 } else {
                     // Pretend the request has been successful to prevent checking which emails really exist
                     // but log that an invalid attempt has been made
-                    log.warn("Password reset request for non existing email '$mail'")
+                    log.warn("Password reset request for non existing email")
                 }
             }.then()
     <%_ } _%>
