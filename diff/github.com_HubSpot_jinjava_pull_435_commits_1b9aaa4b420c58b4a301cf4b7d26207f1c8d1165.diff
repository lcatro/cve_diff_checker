From 1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165 Mon Sep 17 00:00:00 2001
From: Matt Coley <mcoley@hubspot.com>
Date: Tue, 28 Apr 2020 14:20:50 -0400
Subject: [PATCH] Add interpreter to blacklist

---
 .../com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java     | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java b/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java
index 967afb0c4..30549acc9 100644
--- a/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java
+++ b/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java
@@ -2,6 +2,7 @@
 
 import com.google.common.base.CaseFormat;
 import com.google.common.collect.ImmutableSet;
+import com.hubspot.jinjava.interpret.JinjavaInterpreter;
 import java.lang.reflect.Constructor;
 import java.lang.reflect.Field;
 import java.lang.reflect.Method;
@@ -136,7 +137,8 @@ protected boolean isRestrictedClass(Object o) {
       o instanceof Thread ||
       o instanceof Method ||
       o instanceof Field ||
-      o instanceof Constructor
+      o instanceof Constructor ||
+      o instanceof JinjavaInterpreter
     );
   }
 }
