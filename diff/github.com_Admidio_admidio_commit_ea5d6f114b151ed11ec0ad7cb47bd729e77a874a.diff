From ea5d6f114b151ed11ec0ad7cb47bd729e77a874a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Markus=20Fa=C3=9Fbender?= <markus.fassbender@gmail.com>
Date: Sun, 12 Apr 2020 21:29:04 +0200
Subject: [PATCH] Unauthenticated Blind SQL injection #908

---
 adm_program/system/classes/TableAccess.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/adm_program/system/classes/TableAccess.php b/adm_program/system/classes/TableAccess.php
index a9a76e6404..9d04209360 100644
--- a/adm_program/system/classes/TableAccess.php
+++ b/adm_program/system/classes/TableAccess.php
@@ -444,11 +444,11 @@ public function readDataByColumns(array $columnArray)
         // add every array element as a sql condition to the condition string
         foreach ($columnArray as $columnName => $columnValue)
         {
-            $sqlWhereCondition .= ' AND ' . $columnName . ' = \'' . $columnValue . '\' ';
+            $sqlWhereCondition .= ' AND ' . $columnName . ' = ? ';
         }
 
         // call method to read data out of database
-        $returnCode = $this->readData($sqlWhereCondition);
+        $returnCode = $this->readData($sqlWhereCondition, array_values($columnArray));
 
         // save the array fields in the object
         if (!$returnCode)
