From 1653f31cf874eb6df964bea88d58d8e9b98b485e Mon Sep 17 00:00:00 2001
From: jeanlf <jeanlf@gpac.io>
Date: Fri, 30 Apr 2021 10:53:53 +0200
Subject: [PATCH] fixed #1770 (fuzz)

---
 src/media_tools/isom_hinter.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/media_tools/isom_hinter.c b/src/media_tools/isom_hinter.c
index c05d38ccc..9bff67767 100644
--- a/src/media_tools/isom_hinter.c
+++ b/src/media_tools/isom_hinter.c
@@ -1233,7 +1233,7 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 		esd = gf_isom_get_esd(file, sceneT, 1);
 		if (gf_isom_get_sample_count(file, sceneT)==1) {
 			samp = gf_isom_get_sample(file, sceneT, 1, &descIndex);
-			if (gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
+			if (samp && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
 
 				slc.timeScale = slc.timestampResolution = gf_isom_get_media_timescale(file, sceneT);
 				slc.OCRResolution = 1000;
