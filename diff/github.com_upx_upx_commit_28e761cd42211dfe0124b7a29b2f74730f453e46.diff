From a94c7b32e483ca6daca1f63d63a3c587655b2675 Mon Sep 17 00:00:00 2001
From: goushibee <goushibee@qq.com>
Date: Wed, 7 Apr 2021 15:40:13 +0800
Subject: [PATCH] fix issue 486

---
 src/p_mach.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/p_mach.cpp b/src/p_mach.cpp
index d672d7856..8f62a3e5f 100644
--- a/src/p_mach.cpp
+++ b/src/p_mach.cpp
@@ -1552,6 +1552,9 @@ int PackMachBase<T>::canUnpack()
     if (2048 < headway) {
         infoWarning("Mach_header.sizeofcmds(%d) > 2048", headway);
     }
+    if(!headway){
+        throwCantPack("Mach_header.sizeofcmds == 0");
+    }
     rawmseg_buf.alloc(mhdri.sizeofcmds);
     rawmseg = (Mach_segment_command *)rawmseg_buf.getVoidPtr();
     fi->readx(rawmseg, mhdri.sizeofcmds);
