From dbb97a83ccb342c839a54f088aa19b8ba6844b0e Mon Sep 17 00:00:00 2001
From: Maxence Lange <maxence@artificial-owl.com>
Date: Thu, 1 Jul 2021 10:49:43 -0100
Subject: [PATCH] escapeHTML when browsing shared files

Signed-off-by: Maxence Lange <maxence@artificial-owl.com>
---
 js/files/circles.files.list.js | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

diff --git a/js/files/circles.files.list.js b/js/files/circles.files.list.js
index 2da4417cc..78fac5687 100644
--- a/js/files/circles.files.list.js
+++ b/js/files/circles.files.list.js
@@ -22,6 +22,17 @@
  * along with this program.  If not, see <http://www.gnu.org/licenses/>.
  *
  */
+
+
+function escapeHTML(text) {
+	return text.toString()
+		.split('&').join('&amp;')
+		.split('<').join('&lt;')
+		.split('>').join('&gt;')
+		.split('"').join('&quot;')
+		.split('\'').join('&#039;')
+}
+
 (function() {
 	/**
 	 * @class OCA.Circles.FileList
@@ -124,12 +135,11 @@
 				},
 
 				formatResult: function (circle) {
-					return circle.name;
+					return escapeHTML(circle.name);
 				},
 
 				formatSelection: function (circle) {
-					return circle.name;
-					//return OC.SystemTags.getDescriptiveTag(tag)[0].outerHTML;
+					return escapeHTML(circle.name);
 				},
 
 				sortResults: function(results) {
