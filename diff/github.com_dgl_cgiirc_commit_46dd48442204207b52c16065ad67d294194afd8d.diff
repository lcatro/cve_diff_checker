From 46dd48442204207b52c16065ad67d294194afd8d Mon Sep 17 00:00:00 2001
From: David Leadbeater <dgl@dgl.cx>
Date: Tue, 9 May 2017 22:34:22 +0100
Subject: [PATCH] Validate R parameter in irc.cgi

This matches the check done in nph-irc.cgi.
---
 irc.cgi | 1 +
 1 file changed, 1 insertion(+)

diff --git a/irc.cgi b/irc.cgi
index aba37ca..75844a3 100755
--- a/irc.cgi
+++ b/irc.cgi
@@ -73,6 +73,7 @@ require($interface . '.pm');
 
 if(ref $cgi && defined $cgi->{item}) {
    print "\r\n"; # send final header
+   error('Communication socket name is invalid') if $cgi->{R} =~ /[^A-Za-z0-9]/;
    my $name = $cgi->{item};
    exit unless $interface->exists($name);
    $interface->$name($cgi, $config, 0);
