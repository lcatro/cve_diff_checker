From 8fac6455882333cfe3d81c4121d523813e28e31a Mon Sep 17 00:00:00 2001
From: Terry <2358269014@qq.com>
Date: Tue, 26 May 2020 17:18:45 +0800
Subject: [PATCH] check cart page xss bug fix

---
 app/appfront/theme/base/front/checkout/cart/index.php | 2 +-
 app/apphtml5/theme/base/html5/checkout/cart/index.php | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/app/appfront/theme/base/front/checkout/cart/index.php b/app/appfront/theme/base/front/checkout/cart/index.php
index 0f9d07c64..80e7d9a1f 100644
--- a/app/appfront/theme/base/front/checkout/cart/index.php
+++ b/app/appfront/theme/base/front/checkout/cart/index.php
@@ -291,7 +291,7 @@
 csrfVal = "<?= CRequest::getCsrfValue() ?>";
 $(document).ready(function(){
     // set select all checkbox
-    selectall = "<?= Yii::$app->request->get('selectall') ?>";
+    selectall = "<?=  \Yii::$service->helper->htmlEncode(Yii::$app->request->get('selectall')) ?>";
     selectAllChecked = false;
     if (selectall == 1) {
         selectAllChecked = true;
diff --git a/app/apphtml5/theme/base/html5/checkout/cart/index.php b/app/apphtml5/theme/base/html5/checkout/cart/index.php
index 304c124b3..41919f3a4 100644
--- a/app/apphtml5/theme/base/html5/checkout/cart/index.php
+++ b/app/apphtml5/theme/base/html5/checkout/cart/index.php
@@ -172,7 +172,8 @@
 csrfVal = "<?= CRequest::getCsrfValue() ?>";
 $(document).ready(function(){
 	// set select all checkbox
-    selectall = "<?= Yii::$app->request->get('selectall') ?>";
+    // selectall = "<?= Yii::$app->request->get('selectall') ?>";
+    selectall = "<?=  \Yii::$service->helper->htmlEncode(Yii::$app->request->get('selectall')) ?>";
     selectAllChecked = false;
     if (selectall == 1) {
         selectAllChecked = true;
