From 4406d407ad363ee7e4795ee290c9d2430b0413f8 Mon Sep 17 00:00:00 2001
From: Lanh Le <lanhktc@gmail.com>
Date: Sun, 29 Nov 2020 22:16:58 +0700
Subject: [PATCH] Hot fix error xss

---
 app/Plugins/Cms/Content/Admin/CmsCategoryController.php | 4 ++--
 app/Plugins/Cms/Content/Admin/CmsContentController.php  | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/app/Plugins/Cms/Content/Admin/CmsCategoryController.php b/app/Plugins/Cms/Content/Admin/CmsCategoryController.php
index 9dd43a7a0..6e84e7ea9 100644
--- a/app/Plugins/Cms/Content/Admin/CmsCategoryController.php
+++ b/app/Plugins/Cms/Content/Admin/CmsCategoryController.php
@@ -50,8 +50,8 @@ public function index()
             'sort' => trans($this->plugin->pathPlugin.'::Category.sort'),
             'action' => trans($this->plugin->pathPlugin.'::Category.admin.action'),
         ];
-        $sort_order = request('sort_order') ?? 'id_desc';
-        $keyword = request('keyword') ?? '';
+        $sort_order = sc_clean(request('sort_order') ?? 'id_desc');
+        $keyword    = sc_clean(request('keyword') ?? '');
         $arrSort = [
             'id__desc' => trans($this->plugin->pathPlugin.'::Category.admin.sort_order.id_desc'),
             'id__asc' => trans($this->plugin->pathPlugin.'::Category.admin.sort_order.id_asc'),
diff --git a/app/Plugins/Cms/Content/Admin/CmsContentController.php b/app/Plugins/Cms/Content/Admin/CmsContentController.php
index 700b05b7b..e535cb3e3 100644
--- a/app/Plugins/Cms/Content/Admin/CmsContentController.php
+++ b/app/Plugins/Cms/Content/Admin/CmsContentController.php
@@ -48,8 +48,8 @@ public function index()
             'sort'        => trans($this->plugin->pathPlugin.'::Content.sort'),
             'action'      => trans($this->plugin->pathPlugin.'::Content.admin.action'),
         ];
-        $sort_order = request('sort_order') ?? 'id_desc';
-        $keyword = request('keyword') ?? '';
+        $sort_order = sc_clean(request('sort_order') ?? 'id_desc');
+        $keyword    = sc_clean(request('keyword') ?? '');
         $arrSort = [
             'id__desc'    => trans($this->plugin->pathPlugin.'::Content.admin.sort_order.id_desc'),
             'id__asc'     => trans($this->plugin->pathPlugin.'::Content.admin.sort_order.id_asc'),
