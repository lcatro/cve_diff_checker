From 5ab1e37dc8d6415d04354e1a116f3d82e9555f5c Mon Sep 17 00:00:00 2001
From: Marcus  Gesing <gesing@smartstore.com>
Date: Tue, 13 Oct 2020 11:07:10 +0200
Subject: [PATCH] Resolves #2112 Path traversal vulnerability

---
 .../Administration/Controllers/ImportController.cs           | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/Presentation/SmartStore.Web/Administration/Controllers/ImportController.cs b/src/Presentation/SmartStore.Web/Administration/Controllers/ImportController.cs
index 61bc922464..c749d82d2c 100644
--- a/src/Presentation/SmartStore.Web/Administration/Controllers/ImportController.cs
+++ b/src/Presentation/SmartStore.Web/Administration/Controllers/ImportController.cs
@@ -384,6 +384,11 @@ public ActionResult ProfileListDetails(int profileId)
         [Permission(Permissions.Configuration.Import.Create)]
         public ActionResult Create(ImportProfileModel model)
         {
+            if (PathHelper.HasInvalidFileNameChars(model.TempFileName))
+            {
+                return new HttpStatusCodeResult(HttpStatusCode.BadRequest, "Invalid file name.");
+            }
+
             var importFile = Path.Combine(FileSystemHelper.TempDirTenant(), model.TempFileName.EmptyNull());
 
             if (System.IO.File.Exists(importFile))
