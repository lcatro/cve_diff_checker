From 59ebef5978f80e2fdc7b4db4a28b668c5a39fbc3 Mon Sep 17 00:00:00 2001
From: Tim Buckingham <mr@timbuckingham.com>
Date: Mon, 5 Dec 2016 15:35:15 -0500
Subject: [PATCH] Fixing potential XSS attack vector. Thanks to Haojun Hou in
 ADLab of Venustech.

---
 core/admin/ajax/dashboard/check-module-integrity.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/core/admin/ajax/dashboard/check-module-integrity.php b/core/admin/ajax/dashboard/check-module-integrity.php
index 637856f89..cf29b95f7 100644
--- a/core/admin/ajax/dashboard/check-module-integrity.php
+++ b/core/admin/ajax/dashboard/check-module-integrity.php
@@ -48,7 +48,7 @@
 ?>
 <li>
 	<section class="integrity_errors">
-		<a href="<?=ADMIN_ROOT.$module["route"]."/".$action["route"]."/".$_GET["id"]?>/" target="_blank">Edit</a>
+		<a href="<?=ADMIN_ROOT.$module["route"]."/".$action["route"]."/".htmlspecialchars($_GET["id"])?>/" target="_blank">Edit</a>
 		<span class="icon_small icon_small_warning"></span>
 		<p>Broken <?=(($type == "img") ? "Image" : "Link")?>: <?=$error?> in field &ldquo;<?=$form["fields"][$field]["title"]?>&rdquo;</p>
 	</section>
