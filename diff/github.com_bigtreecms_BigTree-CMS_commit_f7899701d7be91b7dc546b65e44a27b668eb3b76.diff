From f7899701d7be91b7dc546b65e44a27b668eb3b76 Mon Sep 17 00:00:00 2001
From: Tim Buckingham <mr@timbuckingham.com>
Date: Thu, 25 May 2017 16:53:05 -0400
Subject: [PATCH] Fixed a user potentially being able to delete themselves if
 they really really wanted to.
 https://github.com/bigtreecms/BigTree-CMS/issues/282

---
 core/inc/bigtree/admin.php | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/core/inc/bigtree/admin.php b/core/inc/bigtree/admin.php
index 6c63ccb84..f2be82889 100755
--- a/core/inc/bigtree/admin.php
+++ b/core/inc/bigtree/admin.php
@@ -2303,7 +2303,8 @@ function deleteUser($id) {
 			$id = sqlescape($id);
 			// If this person has higher access levels than the person trying to update them, fail.
 			$current = static::getUser($id);
-			if ($current["level"] > $this->Level) {
+
+			if ($current["level"] > $this->Level || $id == $this->ID) {
 				return false;
 			}
 
