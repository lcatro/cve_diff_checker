From a93ee1abd2ab19ebe4bf9d684d56637ee54a6074 Mon Sep 17 00:00:00 2001
From: Joseph Birr-Pixton <jpixton@gmail.com>
Date: Sat, 10 Aug 2019 09:47:06 +0100
Subject: [PATCH] tlsserver: fix loop when client will never be writable

---
 rustls-mio/examples/tlsserver.rs | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/rustls-mio/examples/tlsserver.rs b/rustls-mio/examples/tlsserver.rs
index b22ed0804..1b899a978 100644
--- a/rustls-mio/examples/tlsserver.rs
+++ b/rustls-mio/examples/tlsserver.rs
@@ -179,7 +179,7 @@ impl Connection {
             self.do_tls_write_and_handle_error();
         }
 
-        if self.closing && !self.tls_session.wants_write() {
+        if self.closing {
             let _ = self.socket.shutdown(Shutdown::Both);
             self.close_back();
             self.closed = true;
