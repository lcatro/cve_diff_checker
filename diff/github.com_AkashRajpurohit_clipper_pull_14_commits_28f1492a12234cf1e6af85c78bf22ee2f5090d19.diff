From 28f1492a12234cf1e6af85c78bf22ee2f5090d19 Mon Sep 17 00:00:00 2001
From: Akash Rajpurohit <akash@peoplegrove.com>
Date: Wed, 10 Mar 2021 20:04:46 +0530
Subject: [PATCH] fix: check for allowed urls to be opened using
 shell.openExternal :adhesive_bandage:

---
 preload.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/preload.js b/preload.js
index c027826..916966f 100644
--- a/preload.js
+++ b/preload.js
@@ -2,6 +2,10 @@
 // It has the same sandbox as a Chrome extension.
 const { remote, ipcRenderer } = require('electron');
 
+const allowedUrls = ['https://akashrajpurohit.com'];
+
+const isValidUrl = url => allowedUrls.includes(url);
+
 const init = () => {
   window.checkClipboard = () => {
     return remote.clipboard.readText();
@@ -12,7 +16,7 @@ const init = () => {
   };
 
   window.openExternalUrl = (url) => {
-    remote.shell.openExternal(url);
+    if (isValidUrl(url)) remote.shell.openExternal(url);
   };
 
   window.clearClipboard = () => {
