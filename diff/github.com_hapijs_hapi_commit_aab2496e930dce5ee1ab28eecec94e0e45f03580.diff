From 14ca827cb6501b88a5452054f429a92ee3fe0b6e Mon Sep 17 00:00:00 2001
From: Eran Hammer <eran@hammer.io>
Date: Wed, 23 Dec 2015 13:51:44 -0800
Subject: [PATCH 1/3] Handle invalid date exceptions. Closes #2987

---
 lib/transmit.js     | 13 +++++++++++--
 npm-shrinkwrap.json |  2 +-
 package.json        |  2 +-
 3 files changed, 13 insertions(+), 4 deletions(-)

diff --git a/lib/transmit.js b/lib/transmit.js
index 5ab2d0d48..d4ee1f5fd 100755
--- a/lib/transmit.js
+++ b/lib/transmit.js
@@ -82,8 +82,8 @@ internals.marshal = function (request, next) {
 
                 // Weak verifier
 
-                const ifModifiedSince = Date.parse(ifModifiedSinceHeader);
-                const lastModified = Date.parse(lastModifiedHeader);
+                const ifModifiedSince = internals.parseDate(ifModifiedSinceHeader);
+                const lastModified = internals.parseDate(lastModifiedHeader);
 
                 if (ifModifiedSince &&
                     lastModified &&
@@ -147,6 +147,15 @@ internals.marshal = function (request, next) {
 };
 
 
+internals.parseDate = function (string) {
+
+    try {
+        return Date.parse(string);
+    }
+    catch (errIgnore) { }
+};
+
+
 internals.fail = function (request, boom, callback) {
 
     const error = boom.output;
diff --git a/npm-shrinkwrap.json b/npm-shrinkwrap.json
index 1e611ff2d..fa06071ff 100755
--- a/npm-shrinkwrap.json
+++ b/npm-shrinkwrap.json
@@ -1,6 +1,6 @@
 {
     "name": "hapi",
-    "version": "11.1.1",
+    "version": "11.1.3",
     "dependencies": {
         "accept": {
             "version": "2.0.0"
diff --git a/package.json b/package.json
index a67947141..776b696b5 100755
--- a/package.json
+++ b/package.json
@@ -2,7 +2,7 @@
   "name": "hapi",
   "description": "HTTP Server framework",
   "homepage": "http://hapijs.com",
-  "version": "11.1.2",
+  "version": "11.1.3",
   "repository": {
     "type": "git",
     "url": "git://github.com/hapijs/hapi"

From 9f328465611dd81f7dc40b065eb34d5f04f9c8e1 Mon Sep 17 00:00:00 2001
From: Eran Hammer <eran@hammer.io>
Date: Wed, 23 Dec 2015 13:54:29 -0800
Subject: [PATCH 2/3] Update npm-shrinkwrap.json

---
 npm-shrinkwrap.json | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/npm-shrinkwrap.json b/npm-shrinkwrap.json
index fa06071ff..1e611ff2d 100755
--- a/npm-shrinkwrap.json
+++ b/npm-shrinkwrap.json
@@ -1,6 +1,6 @@
 {
     "name": "hapi",
-    "version": "11.1.3",
+    "version": "11.1.1",
     "dependencies": {
         "accept": {
             "version": "2.0.0"

From ef2a0f85d558eeb102c512fac45386b2145cb903 Mon Sep 17 00:00:00 2001
From: Eran Hammer <eran@hammer.io>
Date: Wed, 23 Dec 2015 13:54:39 -0800
Subject: [PATCH 3/3] Update package.json

---
 package.json | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 776b696b5..a67947141 100755
--- a/package.json
+++ b/package.json
@@ -2,7 +2,7 @@
   "name": "hapi",
   "description": "HTTP Server framework",
   "homepage": "http://hapijs.com",
-  "version": "11.1.3",
+  "version": "11.1.2",
   "repository": {
     "type": "git",
     "url": "git://github.com/hapijs/hapi"
