From baf0e460796ea92f6c902fa9b007190bccff2b8f Mon Sep 17 00:00:00 2001
From: Danielss89 <Danielss89@gmail.com>
Date: Thu, 8 Jan 2015 14:18:45 +0100
Subject: [PATCH] Fix XSS vulnerability

---
 view/zfc-user/user/login.phtml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/view/zfc-user/user/login.phtml b/view/zfc-user/user/login.phtml
index 3d1df3bd..66dbfd68 100644
--- a/view/zfc-user/user/login.phtml
+++ b/view/zfc-user/user/login.phtml
@@ -28,5 +28,5 @@ $form->setAttribute('method', 'post');
 <?php echo $this->form()->closeTag() ?>
 
 <?php if ($this->enableRegistration) : ?>
-<?php echo $this->translate('Not registered?'); ?> <a href="<?php echo $this->url('zfcuser/register') . ($this->redirect ? '?redirect='.$this->redirect : '') ?>"><?php echo $this->translate('Sign up!'); ?></a>
+<?php echo $this->translate('Not registered?'); ?> <a href="<?php echo $this->url('zfcuser/register') . ($this->redirect ? '?redirect='.$this->escapeUrl($this->redirect) : '') ?>"><?php echo $this->translate('Sign up!'); ?></a>
 <?php endif; ?>
