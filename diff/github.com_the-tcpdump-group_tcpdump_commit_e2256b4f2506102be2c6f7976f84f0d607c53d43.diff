From e2256b4f2506102be2c6f7976f84f0d607c53d43 Mon Sep 17 00:00:00 2001
From: Francois-Xavier Le Bail <devel.fx.lebail@orange.fr>
Date: Sat, 29 Feb 2020 15:52:39 +0100
Subject: [PATCH] SOME/IP: Fix terminating a "struct tok" array

Moreover:
Declare static and const the "struct tok" arrays.
---
 print-someip.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/print-someip.c b/print-someip.c
index 3f3fcfc67..bd6a74f39 100644
--- a/print-someip.c
+++ b/print-someip.c
@@ -42,7 +42,7 @@
  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  */
 
-struct tok message_type_values[] = {
+static const struct tok message_type_values[] = {
     { 0x00, "REQUEST" },
     { 0x01, "REQUEST_NO_RETURN" },
     { 0x02, "NOTIFICATION" },
@@ -56,7 +56,7 @@ struct tok message_type_values[] = {
     { 0, NULL }
 };
 
-struct tok return_code_values[] = {
+static const struct tok return_code_values[] = {
     { 0x00, "E_OK" },
     { 0x01, "E_NOT_OK" },
     { 0x02, "E_UNKNOWN_SERVICE" },
@@ -73,6 +73,7 @@ struct tok return_code_values[] = {
     { 0x0d, "E_E2E" },
     { 0x0e, "E_E2E_NOT_AVAILABLE" },
     { 0x0f, "E_E2E_NO_NEW_DATA" },
+    { 0, NULL }
 };
 
 void
