From 866c60236c41cea1e1654c8a071897292f64be49 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 8 Feb 2017 10:54:27 -0800
Subject: [PATCH] CVE-2017-13687/CHDLC: Add a test.

This is for the fix made a few commits before, which had no tests.

Add a test using the capture file supplied by Kamil Frankowicz.
---
 tests/TESTLIST               |   1 +
 tests/hoobr_chdlc_print.out  |  26 ++++++++++++++++++++++++++
 tests/hoobr_chdlc_print.pcap | Bin 0 -> 2016 bytes
 3 files changed, 27 insertions(+)
 create mode 100644 tests/hoobr_chdlc_print.out
 create mode 100644 tests/hoobr_chdlc_print.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 7b841e991..ec627cb82 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -455,6 +455,7 @@ hoobr_juniper		hoobr_juniper.pcap		hoobr_juniper.out
 hoobr_juniper2		hoobr_juniper2.pcap		hoobr_juniper2.out
 hoobr_juniper3		hoobr_juniper3.pcap		hoobr_juniper3.out
 hoobr_parse_field	hoobr_parse_field.pcap		hoobr_parse_field.out
+hoobr_chdlc_print	hoobr_chdlc_print.pcap		hoobr_chdlc_print.out
 
 # bad packets from Wilfried Kirsch
 slip-bad-direction	slip-bad-direction.pcap		slip-bad-direction.out	-ve
diff --git a/tests/hoobr_chdlc_print.out b/tests/hoobr_chdlc_print.out
new file mode 100644
index 000000000..5701077db
--- /dev/null
+++ b/tests/hoobr_chdlc_print.out
@@ -0,0 +1,26 @@
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+[|chdlc]
diff --git a/tests/hoobr_chdlc_print.pcap b/tests/hoobr_chdlc_print.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..ffc75a4b214033df32874a86dfd75243e9a44d6b
GIT binary patch
literal 2016
zcmca|c+)~A1{MYbC}3e=V8~#Aa}6ATe3%?HXbB?Cqqe<+-8^E$#e$K#@j;C^9g1d9
nJ3SB^f7G^ju$wnr!e!JSl;v`2r_+%Z9|jDta{u2yQepxCYMyQ3

literal 0
HcmV?d00001

