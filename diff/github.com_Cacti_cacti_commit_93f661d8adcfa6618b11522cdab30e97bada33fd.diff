From 93f661d8adcfa6618b11522cdab30e97bada33fd Mon Sep 17 00:00:00 2001
From: Patrick <patrick@patrickrademaker.nl>
Date: Sat, 7 Oct 2017 17:59:17 +0200
Subject: [PATCH] XSS fix (#1017)

Fix for issue #1010
---
 include/global_session.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/include/global_session.php b/include/global_session.php
index f2587384e..5e38729eb 100644
--- a/include/global_session.php
+++ b/include/global_session.php
@@ -84,11 +84,11 @@
 	var cactiVersion='<?php print $config['cacti_version'];?>';
 	var theme='<?php print get_selected_theme();?>';
 	var refreshIsLogout=<?php print $refreshIsLogout;?>;
-	var refreshPage='<?php print $myrefresh['page'];?>';
+	var refreshPage='<?php print htmlspecialchars($myrefresh['page']);?>';
 	var refreshMSeconds=<?php print $myrefresh['seconds']*1000;?>;
 	var urlPath='<?php print $config['url_path'];?>';
 	var previousPage='';
-	var requestURI='<?php print $_SERVER['REQUEST_URI'];?>';
+	var requestURI='<?php print htmlspecialchars($_SERVER['REQUEST_URI']);?>';
 	var searchFilter='<?php print __('Enter a search term');?>';
 	var searchRFilter='<?php print __('Enter a regular expression');?>';
 	var noFileSelected='<?php print __('No file selected');?>';
