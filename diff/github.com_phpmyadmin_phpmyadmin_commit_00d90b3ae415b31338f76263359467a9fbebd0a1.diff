From 00d90b3ae415b31338f76263359467a9fbebd0a1 Mon Sep 17 00:00:00 2001
From: Madhura Jayaratne <madhura.cj@gmail.com>
Date: Sat, 18 Aug 2018 23:19:58 +1000
Subject: [PATCH] Fix #14548 [security] HTML injection in import warning
 messages

Signed-off-by: Madhura Jayaratne <madhura.cj@gmail.com>
---
 ChangeLog                 | 1 +
 libraries/classes/Sql.php | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 44c7879a08d..b13f48010e7 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -20,6 +20,7 @@ phpMyAdmin - ChangeLog
 - issue #14554 Icon missing when creating a new trigger, routine, and event
 - issue #14422 Table comment not showing since 4.8.1
 - issue #14426 Drop table doesn't work when you copy tables to another database
+- issue #14548 [security] HTML injection in import warning messages
 
 4.8.2 (2018-06-21)
 - issue #14370 WHERE 0 causes Fatal error
diff --git a/libraries/classes/Sql.php b/libraries/classes/Sql.php
index 0933446fd37..9515122db9e 100644
--- a/libraries/classes/Sql.php
+++ b/libraries/classes/Sql.php
@@ -2257,7 +2257,7 @@ public function executeQueryAndGetQueryResponse(array $analyzed_sql_results,
         Util::handleDisableFKCheckCleanup($default_fk_check);
 
         foreach ($warning_messages as $warning) {
-            $message = Message::notice($warning);
+            $message = Message::notice(Message::sanitize($warning));
             $html_output .= $message->getDisplay();
         }
 
