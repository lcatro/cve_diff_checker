From a966e781499ff6fd4eea66876d7532301b13a382 Mon Sep 17 00:00:00 2001
From: Dwi Siswanto <dwi.siswanto98@gmail.com>
Date: Sun, 14 Mar 2021 22:25:42 +0700
Subject: [PATCH] Escapes decompiling arguments

---
 apkleaks/apkleaks.py | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/apkleaks/apkleaks.py b/apkleaks/apkleaks.py
index c51c75e..e1e084f 100644
--- a/apkleaks/apkleaks.py
+++ b/apkleaks/apkleaks.py
@@ -2,6 +2,7 @@
 from apkleaks.colors import clr
 from contextlib import closing
 from distutils.spawn import find_executable
+from pipes import quote
 from pyaxmlparser import APK
 from urllib.request import urlopen
 from zipfile import ZipFile
@@ -84,8 +85,9 @@ def decompile(self):
 					classes.write(zipped.read("classes.dex"))
 			except Exception as e:
 				sys.exit(self.writeln(str(e), clr.WARNING))
-		dec = "%s %s -d %s --deobf" % (self.jadx, dex, self.tempdir)
-		os.system(dec)
+		args = [self.jadx, dex, "-d", self.tempdir, "--deobf"]
+		comm = "%s" % (" ".join(quote(arg) for arg in args))
+		os.system(comm)
 		return self.tempdir
 
 	def unique(self, list): 
