From e3cdce6fe12193f235b8c0ae5efe6880a25eb957 Mon Sep 17 00:00:00 2001
From: Cristy <mikayla-grace@urban-warrior.org>
Date: Sat, 9 Feb 2019 21:20:50 -0500
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1472

---
 coders/cin.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/cin.c b/coders/cin.c
index 6b9b4e50b1..72d6138fd9 100644
--- a/coders/cin.c
+++ b/coders/cin.c
@@ -726,6 +726,8 @@ static Image *ReadCINImage(const ImageInfo *image_info,ExceptionInfo *exception)
       (void) CloseBlob(image);
       return(image);
     }
+  if (((MagickSizeType) image->columns*image->rows) > GetBlobSize(image))
+    ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
   for ( ; offset < (MagickOffsetType) cin.file.image_offset; offset++)
   {
     int
