From 7c526bc6a6a51b57a1bab4c60f104dc36cde347a Mon Sep 17 00:00:00 2001
From: Daniel Fahlke <flyingmana@googlemail.com>
Date: Tue, 18 Aug 2020 19:19:54 +0200
Subject: [PATCH] Merge pull request from GHSA-crf2-xm6x-46p6

---
 app/code/core/Mage/Adminhtml/Controller/Action.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app/code/core/Mage/Adminhtml/Controller/Action.php b/app/code/core/Mage/Adminhtml/Controller/Action.php
index 0e26a8a47d..c236779d1e 100644
--- a/app/code/core/Mage/Adminhtml/Controller/Action.php
+++ b/app/code/core/Mage/Adminhtml/Controller/Action.php
@@ -389,7 +389,7 @@ protected function _validateSecretKey()
         }
 
         if (!($secretKey = $this->getRequest()->getParam(Mage_Adminhtml_Model_Url::SECRET_KEY_PARAM_NAME, null))
-            || $secretKey != Mage::getSingleton('adminhtml/url')->getSecretKey()) {
+            || !hash_equals(Mage::getSingleton('adminhtml/url')->getSecretKey(), $secretKey)) {
             return false;
         }
         return true;
