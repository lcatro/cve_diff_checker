From e6351557b86cc10a7651253d2d2aff7f6b918f8e Mon Sep 17 00:00:00 2001
From: nao-pon <hypweb@gmail.com>
Date: Wed, 28 Mar 2018 14:30:48 +0900
Subject: [PATCH] [php:security] re-fix directory traversal vulnerability for
 windows server

rel. commit 157f471d7e48f190f74e66eb5bc73360b5352fd3
---
 php/elFinder.class.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/php/elFinder.class.php b/php/elFinder.class.php
index bd2aa87a24..fec1143d8a 100644
--- a/php/elFinder.class.php
+++ b/php/elFinder.class.php
@@ -1624,7 +1624,7 @@ protected function zipdl($args) {
 			}
 			$file = $targets[1];
 			// checking the validity of the file parameter
-			if (strpos($file, DIRECTORY_SEPARATOR) !== false) {
+			if (strpos(str_replace('/', DIRECTORY_SEPARATOR, $file), DIRECTORY_SEPARATOR) !== false) {
 				return array('error' => 'File not found', 'header' => $h404, 'raw' => true);
 			}
 			$path = $volume->getTempPath().DIRECTORY_SEPARATOR.$file;
