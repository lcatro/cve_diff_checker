From 2989aa05225aa9b3a592ca50cbf8350ef256909c Mon Sep 17 00:00:00 2001
From: iglocska <andras.iklody@gmail.com>
Date: Mon, 18 May 2020 12:27:44 +0200
Subject: [PATCH] fix: [security] xss in the resolved attributes view

- thanks to Jakub Onderka for reporting it
---
 app/View/Events/resolved_attributes.ctp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app/View/Events/resolved_attributes.ctp b/app/View/Events/resolved_attributes.ctp
index 0bfbc61d90..44b3354fca 100644
--- a/app/View/Events/resolved_attributes.ctp
+++ b/app/View/Events/resolved_attributes.ctp
@@ -99,7 +99,7 @@
                         );
                         $popoverHTML = '';
                         foreach ($popover as $key => $popoverElement) {
-                            $popoverHTML .= '<span class=\'bold\'>' . $key . '</span>: <span class=\'blue bold\'>' . $popoverElement . '</span><br />';
+                            $popoverHTML .= '<span class=\'bold\'>' . $key . '</span>: <span class=\'blue bold\'>' . h($popoverElement) . '</span><br />';
                         }
                 ?>
                         <a href="<?php echo $baseurl; ?>/events/view/<?php echo h($relation['Event']['id']);?>" data-toggle="popover" title="Attribute details" data-content="<?php echo h($popoverHTML); ?>" data-trigger="hover"><?php echo h($relation['Event']['id']);?></a>
