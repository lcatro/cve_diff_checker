From ef111822562d0b9365bd3e671a75b65bd0613353 Mon Sep 17 00:00:00 2001
From: evernat <evernat@free.fr>
Date: Tue, 4 Sep 2018 08:31:29 +0200
Subject: [PATCH] fix for security

---
 .../java/net/bull/javamelody/PayloadNameRequestWrapper.java     | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/javamelody-core/src/main/java/net/bull/javamelody/PayloadNameRequestWrapper.java b/javamelody-core/src/main/java/net/bull/javamelody/PayloadNameRequestWrapper.java
index c2affb3bc..f03c1419f 100644
--- a/javamelody-core/src/main/java/net/bull/javamelody/PayloadNameRequestWrapper.java
+++ b/javamelody-core/src/main/java/net/bull/javamelody/PayloadNameRequestWrapper.java
@@ -235,6 +235,8 @@ private static String parseSoapMethodName(InputStream stream, String charEncodin
 		try {
 			// newInstance() et pas newFactory() pour java 1.5 (issue 367)
 			final XMLInputFactory factory = XMLInputFactory.newInstance();
+			factory.setProperty(XMLInputFactory.SUPPORT_DTD, false); // disable DTDs entirely for that factory
+			factory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false); // disable external entities
 			final XMLStreamReader xmlReader;
 			if (charEncoding != null) {
 				xmlReader = factory.createXMLStreamReader(stream, charEncoding);
