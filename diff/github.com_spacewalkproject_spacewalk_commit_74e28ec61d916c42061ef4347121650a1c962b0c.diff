From 74e28ec61d916c42061ef4347121650a1c962b0c Mon Sep 17 00:00:00 2001
From: Michael Mraka <michael.mraka@redhat.com>
Date: Thu, 16 Jan 2020 14:28:39 +0100
Subject: [PATCH] 1791164 - disable external entity parsing

---
 spec-tree/redstone-xmlrpc/redstone-xmlrpc.spec |  2 ++
 spec-tree/redstone-xmlrpc/xxe2.patch           | 11 +++++++++++
 2 files changed, 13 insertions(+)
 create mode 100644 spec-tree/redstone-xmlrpc/xxe2.patch

diff --git a/spec-tree/redstone-xmlrpc/redstone-xmlrpc.spec b/spec-tree/redstone-xmlrpc/redstone-xmlrpc.spec
index 9179fcce770..0ba07aca4eb 100644
--- a/spec-tree/redstone-xmlrpc/redstone-xmlrpc.spec
+++ b/spec-tree/redstone-xmlrpc/redstone-xmlrpc.spec
@@ -9,6 +9,7 @@ Patch0: build-classpath.patch
 Patch1: fault_serialization.patch
 Patch2: escaping_string_serialization.path
 Patch3: xxe.patch
+Patch4: xxe2.patch
 %if 0%{?fedora} || 0%{?rhel} >=7
 BuildRequires: javapackages-tools
 BuildRequires: jboss-servlet-2.5-api
@@ -34,6 +35,7 @@ a simple xmlrpc library for java
 %patch1 -p0
 %patch2 -p0
 %patch3 -p0
+%patch4 -p0
 rm lib/javax.servlet.jar
 build-jar-repository -p lib/ %third_party_jars
 
diff --git a/spec-tree/redstone-xmlrpc/xxe2.patch b/spec-tree/redstone-xmlrpc/xxe2.patch
new file mode 100644
index 00000000000..59dfb4ef419
--- /dev/null
+++ b/spec-tree/redstone-xmlrpc/xxe2.patch
@@ -0,0 +1,11 @@
+diff '--exclude=CVS' '--exclude=.svn' -ur ../xmlrpc-orig/source/redstone/xmlrpc/XmlRpcParser.java ../xmlrpc/source/redstone/xmlrpc/XmlRpcParser.java
+--- source/redstone/xmlrpc/XmlRpcParser.java	2020-01-16 14:18:28.294284905 +0100
++++ source/redstone/xmlrpc/XmlRpcParser.java	2020-01-16 14:21:57.985203925 +0100
+@@ -135,6 +135,7 @@
+                 {
+                     reader = XMLReaderFactory.createXMLReader();
+                     reader.setEntityResolver(new DummyEntityResolver());
++                    reader.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
+                 }
+                 catch ( SAXException e )
+                 {
