From ce04b1f29a137198182f60bbb628d5ceb8171765 Mon Sep 17 00:00:00 2001
From: Joachim Nilsson <troglobit@gmail.com>
Date: Wed, 24 Jul 2019 07:35:23 +0200
Subject: [PATCH] Fix #1: Ensure recv buf is always NUL terminated

Signed-off-by: Joachim Nilsson <troglobit@gmail.com>
---
 ssdpd.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/ssdpd.c b/ssdpd.c
index 7fe5cab..f6a1297 100644
--- a/ssdpd.c
+++ b/ssdpd.c
@@ -432,13 +432,11 @@ static void ssdp_recv(int sd)
 	ssize_t len;
 	struct sockaddr sa;
 	socklen_t salen;
-	char buf[MAX_PKT_SIZE];
+	char buf[MAX_PKT_SIZE + 1];
 
 	memset(buf, 0, sizeof(buf));
-	len = recvfrom(sd, buf, sizeof(buf), MSG_DONTWAIT, &sa, &salen);
+	len = recvfrom(sd, buf, sizeof(buf) - 1, MSG_DONTWAIT, &sa, &salen);
 	if (len > 0) {
-		buf[len] = 0;
-
 		if (sa.sa_family != AF_INET)
 			return;
 
