From 568e8db44930fda4563c1e708a2440909fd8e5fe Mon Sep 17 00:00:00 2001
From: Pierre-Aymeric Masse <pamasse@afnic.fr>
Date: Mon, 19 Feb 2018 14:49:47 +0100
Subject: [PATCH] Escape HTML

---
 lib/Zonemaster/GUI/Dancer/Export.pm | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/Zonemaster/GUI/Dancer/Export.pm b/lib/Zonemaster/GUI/Dancer/Export.pm
index 2f7bbff..a26278a 100644
--- a/lib/Zonemaster/GUI/Dancer/Export.pm
+++ b/lib/Zonemaster/GUI/Dancer/Export.pm
@@ -31,7 +31,7 @@ any [ 'get', 'post' ] => '/export' => sub {
 				$previous_module = $result->{module};
 			}
 
-			push( @test_results, { is_module => 0, message => $result->{message}, class => "alert alert-$result->{level}" } );
+			push( @test_results, { is_module => 0, message => HTML::Entities::encode($result->{message}), class => "alert alert-$result->{level}" } );
 		}
 
 		my $template_params;
