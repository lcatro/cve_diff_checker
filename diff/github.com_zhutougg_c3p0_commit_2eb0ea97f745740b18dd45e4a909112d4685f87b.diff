From 2eb0ea97f745740b18dd45e4a909112d4685f87b Mon Sep 17 00:00:00 2001
From: zhutougg <zhutougg@secbug.org>
Date: Thu, 20 Dec 2018 21:11:13 +0800
Subject: [PATCH] Repair XXE vulnerability at initialization

---
 src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java b/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java
index 7a0cad0d..bab251ec 100644
--- a/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java
+++ b/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java
@@ -144,6 +144,7 @@ public static C3P0Config extractXmlConfigFromDefaultResource() throws Exception
     public static C3P0Config extractXmlConfigFromInputStream(InputStream is) throws Exception
     {
         DocumentBuilderFactory fact = DocumentBuilderFactory.newInstance();
+	fact.setExpandEntityReferences(false);
         DocumentBuilder db = fact.newDocumentBuilder();
         Document doc = db.parse( is );
 
