From 386d89b072ef0d44cd3b23ea6af3a8c4491f9e96 Mon Sep 17 00:00:00 2001
From: jim-p <jimp@pfsense.org>
Date: Mon, 20 Nov 2017 08:21:20 -0500
Subject: [PATCH] Prevent Clickjacking in CSRF error page

(cherry picked from commit 6026c9dabdd66a154c8a9a5170947ea098959835)
---
 src/usr/local/www/guiconfig.inc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/usr/local/www/guiconfig.inc b/src/usr/local/www/guiconfig.inc
index cd2532f9466..7882a54669b 100644
--- a/src/usr/local/www/guiconfig.inc
+++ b/src/usr/local/www/guiconfig.inc
@@ -57,6 +57,7 @@
 
 /* Include authentication routines */
 /* THIS MUST BE ABOVE ALL OTHER CODE */
+header("X-Frame-Options: SAMEORIGIN");
 if (!$nocsrf) {
 	function csrf_startup() {
 		global $config;
@@ -75,7 +76,6 @@ if (!$omit_nocacheheaders) {
 	header("Pragma: no-cache");
 }
 
-header("X-Frame-Options: SAMEORIGIN");
 require_once("authgui.inc");
 
 /* parse the configuration and include all configuration functions */
