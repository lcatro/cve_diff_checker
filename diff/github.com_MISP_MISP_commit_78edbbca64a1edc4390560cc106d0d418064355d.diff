From 78edbbca64a1edc4390560cc106d0d418064355d Mon Sep 17 00:00:00 2001
From: mokaddem <sami.mokaddem@circl.lu>
Date: Mon, 26 Jul 2021 12:26:11 +0200
Subject: [PATCH] fix: [security] Stored XSS when forking a galaxy cluster As
 reported by Giuseppe Diego Gianni

---
 app/View/GalaxyClusters/add.ctp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app/View/GalaxyClusters/add.ctp b/app/View/GalaxyClusters/add.ctp
index 3228d52aa2..2ce5fe421e 100644
--- a/app/View/GalaxyClusters/add.ctp
+++ b/app/View/GalaxyClusters/add.ctp
@@ -5,7 +5,7 @@
     if (isset($forkedClusterMeta)) {
         foreach ($forkedClusterMeta as $key => $value) {
             if (is_array($value)) {
-                $forkedClusterHtmlPreview .= sprintf('<div><b>%s: </b><div data-toggle="json" class="large-left-margin">%s</div></div>', h($key), json_encode($value));
+                $forkedClusterHtmlPreview .= sprintf('<div><b>%s: </b><div data-toggle="json" class="large-left-margin">%s</div></div>', h($key), json_encode(h($value)));
             } else {
                 $forkedClusterHtmlPreview .= sprintf('<div><b>%s: </b>%s</div>', h($key), h($value));
             }
