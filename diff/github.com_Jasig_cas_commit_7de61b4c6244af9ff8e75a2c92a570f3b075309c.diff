From 1dad29c71a3d601cf9c00f03a0803186e4123b29 Mon Sep 17 00:00:00 2001
From: "Marvin S. Addison" <marvin.addison@gmail.com>
Date: Wed, 5 Mar 2014 11:22:29 -0500
Subject: [PATCH] CAS-1429 Escape inputs into LDAP filter expressions.

This prevents LDAP injection attacks.
---
 .../src/main/java/org/jasig/cas/util/LdapUtils.java             | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/cas-server-support-ldap/src/main/java/org/jasig/cas/util/LdapUtils.java b/cas-server-support-ldap/src/main/java/org/jasig/cas/util/LdapUtils.java
index 4b256f6df370..e90bbaaa9d6d 100644
--- a/cas-server-support-ldap/src/main/java/org/jasig/cas/util/LdapUtils.java
+++ b/cas-server-support-ldap/src/main/java/org/jasig/cas/util/LdapUtils.java
@@ -76,7 +76,7 @@ public static String getFilterWithValues(final String filter,
         }
 
         for (final String key : properties.keySet()) {
-            final String value = LdapEncoder.nameEncode(properties.get(key));
+            final String value = LdapEncoder.filterEncode(properties.get(key));
             newFilter = newFilter.replaceAll(key, Matcher.quoteReplacement(value));
         }
 
