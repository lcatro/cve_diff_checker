From 8fd069f6dedb064339f1091069ac96f3f8bdb552 Mon Sep 17 00:00:00 2001
From: bel2125 <bel2125@gmail.com>
Date: Sat, 16 Jun 2018 00:48:25 +0200
Subject: [PATCH] Check length of memcmp

---
 src/civetweb.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/civetweb.c b/src/civetweb.c
index 4c8855134..f3fcb8c0a 100644
--- a/src/civetweb.c
+++ b/src/civetweb.c
@@ -11611,10 +11611,10 @@ send_ssi_file(struct mg_connection *conn,
 					/* Handle SSI tag */
 					buf[len] = 0;
 
-					if (!memcmp(buf + 5, "include", 7)) {
+					if ((len > 12) && !memcmp(buf + 5, "include", 7)) {
 						do_ssi_include(conn, path, buf + 12, include_level + 1);
 #if !defined(NO_POPEN)
-					} else if (!memcmp(buf + 5, "exec", 4)) {
+					} else if ((len > 9) && !memcmp(buf + 5, "exec", 4)) {
 						do_ssi_exec(conn, buf + 9);
 #endif /* !NO_POPEN */
 					} else {
