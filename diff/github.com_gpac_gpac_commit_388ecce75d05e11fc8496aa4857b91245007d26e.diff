From 388ecce75d05e11fc8496aa4857b91245007d26e Mon Sep 17 00:00:00 2001
From: jeanlf <jeanlf@gpac.io>
Date: Mon, 7 Sep 2020 09:20:37 +0200
Subject: [PATCH] fixed #1587

---
 src/isomedia/box_code_base.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/isomedia/box_code_base.c b/src/isomedia/box_code_base.c
index 36b54ccb00..c79cfcc8e0 100644
--- a/src/isomedia/box_code_base.c
+++ b/src/isomedia/box_code_base.c
@@ -580,6 +580,10 @@ GF_Err url_box_read(GF_Box *s, GF_BitStream *bs)
 		ptr->location = (char*)gf_malloc((u32) ptr->size);
 		if (! ptr->location) return GF_OUT_OF_MEM;
 		gf_bs_read_data(bs, ptr->location, (u32)ptr->size);
+		if (ptr->location[ptr->size-1]) {
+			GF_LOG(GF_LOG_ERROR, GF_LOG_CONTAINER, ("[iso file] url box location is not 0-terminated\n" ));
+			return GF_ISOM_INVALID_FILE;
+		}
 	}
 	return GF_OK;
 }
