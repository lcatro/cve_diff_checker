From 91c937e03c876ba1290b6de2a3ad953d2105fdd0 Mon Sep 17 00:00:00 2001
From: Gemorroj <wapinet@gmail.com>
Date: Sat, 10 Feb 2018 20:40:14 +0300
Subject: [PATCH] remove eval-s

---
 src/whois.parser.php | 24 +++++++++++++++---------
 1 file changed, 15 insertions(+), 9 deletions(-)

diff --git a/src/whois.parser.php b/src/whois.parser.php
index 7258919..a19a1df 100644
--- a/src/whois.parser.php
+++ b/src/whois.parser.php
@@ -102,10 +102,12 @@ function generic_parser_a_blocks($rawdata, $translate, &$disclaimer)
             $k = $translate[$k];
             if ($k == '') continue;
             if (strstr($k, '.')) {
-                eval("\$block" . getvarname($k) . "=\$v;");
+                ${'block' . getvarname($k)} = $v;
                 continue;
             }
-        } else $k = strtolower($k);
+        } else {
+            $k = strtolower($k);
+        }
 
         if ($k == 'handle') {
             $v = strtok($v, ' ');
@@ -345,15 +347,16 @@ function generic_parser_b($rawdata, $items = false, $dateformat = 'mdy', $hasreg
 
                 if ($pos !== false) {
                     if ($field != '') {
-                        $var = '$r' . getvarname($field);
                         $itm = trim(substr($val, $pos + strlen($match)));
 
-                        if ($itm != '')
-                            eval($var . '="' . str_replace('"', '\"', $itm) . '";');
+                        if ($itm != '') {
+                            ${'r' . getvarname($field)} = '="' . str_replace('"', '\"', $itm) . '";';
+                        }
                     }
 
-                    if (!$scanall)
+                    if (!$scanall) {
                         break;
+                    }
                 }
             }
         }
@@ -418,7 +421,8 @@ function get_blocks($rawdata, $items, $partial_match = false, $def_block = false
                 } else {
                     $var = getvarname(strtok($field, '#'));
                     $itm = trim(substr($val, $pos + strlen($match)));
-                    eval('$r' . $var . '=$itm;');
+
+                    ${'r' . $var} = $itm;
                 }
 
                 break;
@@ -480,7 +484,9 @@ function get_blocks($rawdata, $items, $partial_match = false, $def_block = false
 
             if ($pos !== false) {
                 $var = getvarname(strtok($field, '#'));
-                if ($var != '[]') eval('$r' . $var . '=$block;');
+                if ($var != '[]') {
+                    ${'r' . $var} = $block;
+                }
             }
         }
     }
@@ -586,7 +592,7 @@ function get_contact($array, $extra_items = '', $has_org = false)
                 $itm = trim(substr($val, $pos + strlen($match)));
 
                 if ($field != '' && $itm != '') {
-                    eval('$r' . getvarname($field) . '=$itm;');
+                    ${'r' . getvarname($field)} = $itm;
                 }
 
                 $val = trim(substr($val, 0, $pos));
