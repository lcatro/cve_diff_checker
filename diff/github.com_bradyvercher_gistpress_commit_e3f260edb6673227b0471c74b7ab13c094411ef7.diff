From e3f260edb6673227b0471c74b7ab13c094411ef7 Mon Sep 17 00:00:00 2001
From: Brady Vercher <brady@blazersix.com>
Date: Thu, 16 Jan 2020 11:16:56 -0800
Subject: [PATCH] Sanitize the shortcode id attribute.

---
 includes/class-gistpress.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/includes/class-gistpress.php b/includes/class-gistpress.php
index c6127e8..9ee484d 100644
--- a/includes/class-gistpress.php
+++ b/includes/class-gistpress.php
@@ -681,6 +681,7 @@ protected function standardize_attributes( array $rawattr ) {
 
 		// Sanitize attributes.
 		$attr = shortcode_atts( $defaults, $rawattr );
+		$attr['id']                = preg_replace( '/[^a-z0-9]+/i', '', $attr['id'] );
 		$attr['embed_stylesheet']  = $this->shortcode_bool( $attr['embed_stylesheet'] );
 		$attr['show_line_numbers'] = $this->shortcode_bool( $attr['show_line_numbers'] );
 		$attr['show_meta']         = $this->shortcode_bool( $attr['show_meta'] );
