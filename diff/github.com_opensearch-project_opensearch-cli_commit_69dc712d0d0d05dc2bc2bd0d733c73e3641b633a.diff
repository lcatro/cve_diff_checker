From 69dc712d0d0d05dc2bc2bd0d733c73e3641b633a Mon Sep 17 00:00:00 2001
From: Vijayan Balasubramanian <balasvij@amazon.com>
Date: Wed, 27 Oct 2021 10:29:44 -0700
Subject: [PATCH] Update default folder and file permission

Update folder path to 700 and file path to 600.

Signed-off-by: Vijayan Balasubramanian <balasvij@amazon.com>
---
 commands/root.go | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/commands/root.go b/commands/root.go
index 8a7a295..f8167e5 100644
--- a/commands/root.go
+++ b/commands/root.go
@@ -40,7 +40,8 @@ const (
 	defaultConfigFileName = "config"
 	flagConfig            = "config"
 	flagProfileName       = "profile"
-	folderPermission      = 0755 // only owner can write, while everyone can read and execute
+	FolderPermission      = 0700 // only owner can read, write and execute
+	FilePermission        = 0600 // only owner can read and write
 	ConfigEnvVarName      = "OPENSEARCH_CLI_CONFIG"
 	RootCommandName       = "opensearch-cli"
 	version               = "1.0.0"
@@ -118,7 +119,7 @@ func createDefaultConfigFileIfNotExists() error {
 	}
 	folderPath := filepath.Dir(defaultFilePath)
 	if !isExists(folderPath) {
-		err := os.Mkdir(folderPath, folderPermission)
+		err := os.Mkdir(folderPath, FolderPermission)
 		if err != nil {
 			return err
 		}
@@ -127,6 +128,9 @@ func createDefaultConfigFileIfNotExists() error {
 	if err != nil {
 		return err
 	}
+	if err = f.Chmod(FilePermission); err != nil {
+		return err
+	}
 	return f.Close()
 }
 
