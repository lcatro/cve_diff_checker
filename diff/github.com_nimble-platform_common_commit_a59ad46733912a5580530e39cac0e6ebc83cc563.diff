From a59ad46733912a5580530e39cac0e6ebc83cc563 Mon Sep 17 00:00:00 2001
From: dogukan10 <dogukan10cav@gmail.com>
Date: Mon, 26 Jul 2021 14:22:37 +0300
Subject: [PATCH] Use parseClaimsJws method instead of parseJws

---
 .../main/java/eu/nimble/utility/validation/ValidationUtil.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/utility/src/main/java/eu/nimble/utility/validation/ValidationUtil.java b/utility/src/main/java/eu/nimble/utility/validation/ValidationUtil.java
index b235dd3..4078ad9 100644
--- a/utility/src/main/java/eu/nimble/utility/validation/ValidationUtil.java
+++ b/utility/src/main/java/eu/nimble/utility/validation/ValidationUtil.java
@@ -36,7 +36,7 @@ public Claims validateToken(String token) throws AuthenticationException {
             RsaKeyUtil rsaKeyUtil = new RsaKeyUtil();
             PublicKey publicKey = rsaKeyUtil.fromPemEncoded(keycloakPublicKey);
 
-            return Jwts.parser().setSigningKey(publicKey).parseJws(token.replace("Bearer ", "")).getBody();
+            return Jwts.parser().setSigningKey(publicKey).parseClaimsJws(token.replace("Bearer ", "")).getBody();
         } catch (Exception e){
             throw new AuthenticationException(String.format("Failed to check user authorization for token: %s", token), e);
         }
