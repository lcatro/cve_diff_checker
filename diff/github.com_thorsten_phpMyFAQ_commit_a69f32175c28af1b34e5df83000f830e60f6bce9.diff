From a69f32175c28af1b34e5df83000f830e60f6bce9 Mon Sep 17 00:00:00 2001
From: Thorsten Rinne <thorsten@phpmyfaq.de>
Date: Wed, 22 Mar 2017 08:44:49 +0100
Subject: [PATCH] Added missing sanitizing

---
 phpmyfaq/inc/PMF/Faq.php | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/phpmyfaq/inc/PMF/Faq.php b/phpmyfaq/inc/PMF/Faq.php
index 35f401cf10..1c7ac24d29 100755
--- a/phpmyfaq/inc/PMF/Faq.php
+++ b/phpmyfaq/inc/PMF/Faq.php
@@ -2137,7 +2137,7 @@ public function getTopTenData($count = PMF_NUMBER_RECORDS_TOPTEN, $categoryId =
                 }
 
                 $data['visits'] = (int)$row->visits;
-                $data['question'] = $row->question;
+                $data['question'] = PMF_Filter::filterVar($row->question, FILTER_SANITIZE_STRING);
                 $data['date'] = $row->updated;
                 $data['last_visit'] = $row->last_visit;
 
@@ -2246,7 +2246,7 @@ public function getLatestData($count = PMF_NUMBER_RECORDS_LATEST, $language = nu
                 }
 
                 $data['date'] = $row->updated;
-                $data['question'] = $row->question;
+                $data['question'] = PMF_Filter::filterVar($row->question, FILTER_SANITIZE_STRING);
                 $data['answer'] = $row->content;
                 $data['visits'] = $row->visits;
 
@@ -2260,7 +2260,7 @@ public function getLatestData($count = PMF_NUMBER_RECORDS_LATEST, $language = nu
                     $row->lang
                 );
                 $oLink = new PMF_Link($url, $this->_config);
-                $oLink->itemTitle = $row->question;
+                $oLink->itemTitle = $title;
                 $oLink->tooltip = $title;
                 $data['url'] = $oLink->toString();
 
