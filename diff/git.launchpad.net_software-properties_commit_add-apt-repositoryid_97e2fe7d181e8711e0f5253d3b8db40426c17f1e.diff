From 97e2fe7d181e8711e0f5253d3b8db40426c17f1e Mon Sep 17 00:00:00 2001
From: Marc Deslauriers <marc.deslauriers@canonical.com>
Date: Mon, 17 Aug 2020 10:38:59 -0400
Subject: add-apt-repository: strip ANSI sequences from the description.

---
 add-apt-repository | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

(limited to 'add-apt-repository')

diff --git a/add-apt-repository b/add-apt-repository
index ba33aa5..cf0e3c9 100755
--- a/add-apt-repository
+++ b/add-apt-repository
@@ -4,6 +4,7 @@ from __future__ import print_function
 
 import io
 import os
+import re
 import sys
 import gettext
 import locale
@@ -129,8 +130,11 @@ class AddAptRepository(object):
         '''Display more information about the shortcut / ppa info'''
         print(_("Repository: '%s'") % shortcut.SourceEntry().line)
         if shortcut.description:
+            # strip ANSI escape sequences
+            description = re.sub(r"(\x9B|\x1B\[)[0-?]*[ -/]*[@-~]",
+                                 "", shortcut.description)
             print(_("Description:"))
-            print(shortcut.description)
+            print(description)
         if shortcut.web_link:
             print(_("More info: %s") % shortcut.web_link)
         if self.options.remove:
-- 
cgit v1.1

