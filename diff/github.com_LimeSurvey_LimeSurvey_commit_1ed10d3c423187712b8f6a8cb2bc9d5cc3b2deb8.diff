From 1ed10d3c423187712b8f6a8cb2bc9d5cc3b2deb8 Mon Sep 17 00:00:00 2001
From: LouisGac <louis.gac@limesurvey.org>
Date: Thu, 14 Mar 2019 15:29:43 +0100
Subject: [PATCH] [security] Fixed issue #14617: relative path allowed in lsa
 multiple download

---
 application/controllers/admin/export.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/application/controllers/admin/export.php b/application/controllers/admin/export.php
index 04d984ef4c..5d5ae67719 100644
--- a/application/controllers/admin/export.php
+++ b/application/controllers/admin/export.php
@@ -919,6 +919,7 @@ public function exportMultipleSurveys($sSurveys, $sExportType)
     public function downloadZip($sZip)
     {
         $sTempDir     = Yii::app()->getConfig("tempdir");
+        $sZip         = get_absolute_path($sZip);
         $aZIPFileName = $sTempDir.DIRECTORY_SEPARATOR.$sZip;
 
         if (is_file($aZIPFileName)) {
