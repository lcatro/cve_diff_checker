From ee4017379db0059566ecb5424274ad4e2d66bc68 Mon Sep 17 00:00:00 2001
From: Sushant <sushantdhiman@outlook.com>
Date: Thu, 20 Jun 2019 10:56:22 +0530
Subject: [PATCH] fix(postgres): json path key quoting (#11088)

---
 lib/dialects/abstract/query-generator.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/lib/dialects/abstract/query-generator.js b/lib/dialects/abstract/query-generator.js
index 0298381093..392e962021 100644
--- a/lib/dialects/abstract/query-generator.js
+++ b/lib/dialects/abstract/query-generator.js
@@ -2198,7 +2198,8 @@ var QueryGenerator = {
             path[path.length - 1] = $tmp[0];
           }
 
-          $baseKey = self.quoteIdentifier(key)+'#>>\'{'+path.join(', ')+'}\'';
+          var pathKey = self.escape('{' + path.join(', ') + '}');
+          $baseKey = self.quoteIdentifier(key)+'#>>'+pathKey;
 
           if (options.prefix) {
             if (options.prefix instanceof Utils.literal) {
