From 0533a4864b1920fd8fbb5287bc0889193c5faf44 Mon Sep 17 00:00:00 2001
From: Mike McNeil <git+mikermcneil@sailsjs.com>
Date: Sun, 23 Sep 2018 16:38:55 -0500
Subject: [PATCH] Follow up to ff02114eaec090ee51db48435cc32d451662606e to
 ensure req.path is good and stringy.

---
 lib/receive-incoming-sails-io-msg.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/receive-incoming-sails-io-msg.js b/lib/receive-incoming-sails-io-msg.js
index 5be5704..39ebccd 100644
--- a/lib/receive-incoming-sails-io-msg.js
+++ b/lib/receive-incoming-sails-io-msg.js
@@ -106,7 +106,10 @@ module.exports = function ToReceiveIncomingSailsIOMsg(app) {
 
       url     : options.incomingSailsIOMsg.url,
 
-      path    : url.parse(options.incomingSailsIOMsg.url).pathname,
+      path    : url.parse(options.incomingSailsIOMsg.url).pathname || '/',
+      // ^^ Uses || '/' because otherwise url.parse returns `null`,
+      // which is not a string and thus bad when you try to check
+      // .match() of it.
 
       method  : options.eventName,
 
